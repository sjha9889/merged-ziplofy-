import{u as J,b as K,I as Q,r as s,j as e}from"./index-C7S6h9OR.js";import{B as n,T as a}from"./Box-Cgm3ZkZ8.js";import{S as i}from"./Stack-CYPs5YkO.js";import{I as b}from"./IconButton-BnkdM8yk.js";import{A as V}from"./ArrowBack-CB8ALDU6.js";import{P as X,S as Y}from"./Person-t-osCqUH.js";import{A as Z,C as j}from"./ContentCopy-dfDJtBg6.js";import{B as $}from"./Button-CdPvNkrY.js";import{P as v}from"./Paper-DocVmpOE.js";import{L as U}from"./Link-BuWh3ioJ.js";import{T as d}from"./TextField-CwtyivJh.js";import{I as S}from"./InputAdornment-CoWoQ4-e.js";import"./DefaultPropsProvider-CZkfTDs_.js";import"./createSvgIcon-Yi9Vo0kN.js";import"./SwitchBase-CsFsELPE.js";import"./Select-Bus390RW.js";import"./index-CCB_rw4P.js";const M={p:3,borderRadius:2,border:"1px solid #e5e7eb",backgroundColor:"#fff"},y=["https://shopify.com","https://example.myshopify.com"],A=["https://shopify.com/authentication/placeholder/social/facebook/callback","https://example.myshopify.com/authentication/social/facebook/callback"],C=["https://shopify.com/authentication/placeholder/social/facebook/revoke","https://example.myshopify.com/authentication/social/facebook/revoke"],me=()=>{const E=J(),{activeStoreId:f}=K(),{settings:o,loading:P,error:I,fetchByStoreId:R,update:T}=Q(),[c,x]=s.useState(!1),[h,m]=s.useState(""),[u,k]=s.useState(""),[w,z]=s.useState(y),[D,F]=s.useState(A),[O,W]=s.useState(C),[_,l]=s.useState(!1),[L,B]=s.useState(!1),q=()=>{E("/settings/customer-accounts/authentication")},g=t=>navigator.clipboard.writeText(t);s.useEffect(()=>{f&&R(f).catch(()=>{})},[f,R]),s.useEffect(()=>{if(!o?.facebookAuth){x(!1),m(""),k(""),z(y),F(A),W(C),l(!1);return}x(!!o.facebookAuth.enabled),m(o.facebookAuth.appId||""),k(o.facebookAuth.appSecret||""),z(o.facebookAuth.domains?.length?o.facebookAuth.domains:y),F(o.facebookAuth.redirectURLs?.length?o.facebookAuth.redirectURLs:A),W(o.facebookAuth.deauthorizeCallbackURLs?.length?o.facebookAuth.deauthorizeCallbackURLs:C),l(!1)},[o]),s.useEffect(()=>{if(!o){l(!1);return}const t=!!o.facebookAuth?.enabled,r=o.facebookAuth?.appId||"",H=o.facebookAuth?.appSecret||"",N=c!==t||h.trim()!==r||u.trim()!==H;l(N)},[c,h,u,o]);const G=async()=>{if(o?._id)try{B(!0),await T(o._id,{facebookAuth:{enabled:c,appId:h.trim(),appSecret:u.trim(),domains:w,redirectURLs:D,deauthorizeCallbackURLs:O}}),l(!1)}catch{}finally{B(!1)}},p=P||L||!o;return e.jsxs(n,{sx:{maxWidth:960,mx:"auto",py:4},children:[e.jsxs(i,{direction:"row",alignItems:"center",spacing:1.5,sx:{mb:2},children:[e.jsx(b,{onClick:q,size:"small",sx:{border:"1px solid rgba(17, 24, 39, 0.1)",backgroundColor:"#fff"},children:e.jsx(V,{fontSize:"small"})}),e.jsx(X,{sx:{color:"#374151",fontSize:20}}),e.jsx(Z,{sx:{color:"#9ca3af",fontSize:16}}),e.jsx(a,{variant:"h4",sx:{fontWeight:600,color:"#111827",flexGrow:1},children:"Sign in with Facebook"}),o&&e.jsx($,{variant:"contained",color:"primary",onClick:G,disabled:!_||p,sx:{textTransform:"none",fontWeight:600,borderRadius:1.5,minWidth:120},children:L?"Saving...":"Save"}),e.jsx(Y,{checked:c,onChange:t=>x(t.target.checked),disabled:p,sx:{ml:2,"& .MuiSwitch-switchBase.Mui-checked":{color:"#111827"},"& .MuiSwitch-switchBase.Mui-checked + .MuiSwitch-track":{backgroundColor:"#111827"}}}),e.jsx(a,{variant:"body2",sx:{color:"#6b7280"},children:c?"On":"Off"})]}),e.jsx(a,{variant:"body1",sx:{color:"#6b7280",mb:4},children:"Enable customers to sign in using their Facebook account"}),I&&e.jsx(v,{elevation:0,sx:{mb:3,p:2,borderRadius:1.5,border:"1px solid #fecaca",backgroundColor:"#fef2f2",color:"#b91c1c"},children:I}),e.jsxs(i,{spacing:3,children:[e.jsxs(v,{elevation:0,sx:M,children:[e.jsx(a,{variant:"h6",sx:{fontWeight:600,color:"#111827",mb:2},children:"Setup instructions"}),e.jsxs(a,{variant:"body2",sx:{color:"#4b5563",mb:3},children:["In the"," ",e.jsx(U,{href:"https://developers.facebook.com",target:"_blank",rel:"noopener noreferrer",sx:{color:"#2563eb",textDecoration:"none","&:hover":{textDecoration:"underline"}},children:"Meta for Developers"})," ",'console, create a new App and add "Facebook Login" using the instructions provided in the'," ",e.jsx(U,{href:"#",sx:{color:"#2563eb",textDecoration:"none","&:hover":{textDecoration:"underline"}},children:"help documentation"})," ","and the following configuration."]}),e.jsxs(n,{sx:{mb:3},children:[e.jsx(a,{variant:"subtitle2",sx:{fontWeight:600,color:"#111827",mb:1},children:"Domains"}),e.jsx(i,{spacing:1.5,children:w.map((t,r)=>e.jsx(d,{fullWidth:!0,value:t,InputProps:{readOnly:!0,endAdornment:e.jsx(S,{position:"end",children:e.jsx(b,{size:"small",onClick:()=>g(t),sx:{color:"#6b7280"},children:e.jsx(j,{fontSize:"small"})})}),sx:{borderRadius:1.5,backgroundColor:"#f9fafb","& .MuiOutlinedInput-notchedOutline":{borderColor:"#e5e7eb"}}},size:"small"},r))})]}),e.jsxs(n,{sx:{mb:3},children:[e.jsx(a,{variant:"subtitle2",sx:{fontWeight:600,color:"#111827",mb:1},children:"Redirect URLs"}),e.jsx(i,{spacing:1.5,children:D.map((t,r)=>e.jsx(d,{fullWidth:!0,value:t,InputProps:{readOnly:!0,endAdornment:e.jsx(S,{position:"end",children:e.jsx(b,{size:"small",onClick:()=>g(t),sx:{color:"#6b7280"},children:e.jsx(j,{fontSize:"small"})})}),sx:{borderRadius:1.5,backgroundColor:"#f9fafb","& .MuiOutlinedInput-notchedOutline":{borderColor:"#e5e7eb"}}},size:"small"},r))})]}),e.jsxs(n,{children:[e.jsx(a,{variant:"subtitle2",sx:{fontWeight:600,color:"#111827",mb:1},children:"Deauthorize callback URLs"}),e.jsx(i,{spacing:1.5,children:O.map((t,r)=>e.jsx(d,{fullWidth:!0,value:t,InputProps:{readOnly:!0,endAdornment:e.jsx(S,{position:"end",children:e.jsx(b,{size:"small",onClick:()=>g(t),sx:{color:"#6b7280"},children:e.jsx(j,{fontSize:"small"})})}),sx:{borderRadius:1.5,backgroundColor:"#f9fafb","& .MuiOutlinedInput-notchedOutline":{borderColor:"#e5e7eb"}}},size:"small"},r))})]})]}),e.jsxs(v,{elevation:0,sx:M,children:[e.jsx(a,{variant:"h6",sx:{fontWeight:600,color:"#111827",mb:2},children:"Credentials"}),e.jsx(a,{variant:"body2",sx:{color:"#4b5563",mb:3},children:"Once created, copy the App ID and App Secret shown by Facebook and paste them below."}),e.jsxs(i,{spacing:2,children:[e.jsxs(n,{children:[e.jsx(d,{fullWidth:!0,label:"App ID",required:!0,placeholder:"From Facebook Developers portal",value:h,onChange:t=>m(t.target.value),disabled:p,sx:{"& .MuiOutlinedInput-root":{borderRadius:1.5}}}),e.jsx(a,{variant:"caption",sx:{color:"#6b7280",mt:.5,display:"block"},children:"From Facebook Developers portal"})]}),e.jsxs(n,{children:[e.jsx(d,{fullWidth:!0,label:"App Secret",required:!0,placeholder:"From Facebook Developers portal",value:u,onChange:t=>k(t.target.value),type:"password",disabled:p,sx:{"& .MuiOutlinedInput-root":{borderRadius:1.5}}}),e.jsx(a,{variant:"caption",sx:{color:"#6b7280",mt:.5,display:"block"},children:"From Facebook Developers portal"})]})]})]})]})]})};export{me as default};
