import{r as t,j as e,B as Y,b as G,u as H,Y as O,X as R,i as $,g as J}from"./index-C7S6h9OR.js";import{M as T}from"./Modal-DsfhGJdg.js";import{F as K}from"./ChevronRightIcon-CVun6pAX.js";import{F as Q}from"./PencilSquareIcon-D1uXnPT-.js";import{F as U,a as Z}from"./ArrowUpIcon-CKyaagdL.js";import{F as I}from"./Squares2X2Icon-BWDWCp4N.js";import"./index-CCB_rw4P.js";const ee=({isOpen:s,name:r,storeId:a,onNameChange:n,onClose:o,onCreate:i})=>{const c=t.useCallback(h=>{n(h.target.value)},[n]);return e.jsx(T,{open:s,onClose:o,title:"Create customer segment",maxWidth:"sm",actions:e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:o,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:i,disabled:!r.trim()||!a,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg transition-colors",children:"Create segment"})]}),children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"create-segment-name",className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Name"}),e.jsx("input",{id:"create-segment-name",type:"text",value:r,onChange:c,className:"w-full px-4 py-2.5 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500/30 focus:border-blue-400 outline-none transition-all",placeholder:"Enter segment name",autoFocus:!0})]})})},te=({segment:s,onSegmentClick:r,onEditClick:a})=>{const n=t.useCallback(()=>{r(s._id)},[s._id,r]),o=t.useCallback(i=>{a(i,s._id,s.name)},[s._id,s.name,a]);return e.jsxs("tr",{className:"hover:bg-gray-50/80 cursor-pointer transition-colors group",onClick:n,children:[e.jsx("td",{className:"px-5 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-gray-900",children:s.name}),e.jsx(K,{className:"w-4 h-4 text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity"})]})}),e.jsx("td",{className:"px-5 py-4 text-sm text-gray-500",children:new Date(s.createdAt).toLocaleDateString()}),e.jsx("td",{className:"px-5 py-4 text-right",children:e.jsxs("button",{type:"button",onClick:o,className:"inline-flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:[e.jsx(Q,{className:"w-4 h-4"}),"Edit"]})})]})},se=({segments:s,sortOrder:r,onSortToggle:a,onSegmentClick:n,onEditClick:o})=>{const i=t.useCallback(()=>{a()},[a]);return e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50/80",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-5 py-3.5 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Segment name"}),e.jsx("th",{className:"px-5 py-3.5 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider cursor-pointer hover:bg-gray-100/80 transition-colors",onClick:i,children:e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{children:"Created"}),r==="asc"?e.jsx(U,{className:"w-4 h-4 text-gray-500"}):e.jsx(Z,{className:"w-4 h-4 text-gray-500"})]})}),e.jsx("th",{className:"px-5 py-3.5 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-100",children:s.map(c=>e.jsx(te,{segment:c,onSegmentClick:n,onEditClick:o},c._id))})]})})},ae=({isOpen:s,editName:r,onNameChange:a,onClose:n,onSave:o})=>{const i=t.useCallback(c=>{a(c.target.value)},[a]);return e.jsx(T,{open:s,onClose:n,title:"Edit customer segment",maxWidth:"sm",actions:e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:n,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:o,disabled:!r.trim(),className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg transition-colors",children:"Save"})]}),children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"edit-segment-name",className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Name"}),e.jsx("input",{id:"edit-segment-name",type:"text",value:r,onChange:i,className:"w-full px-4 py-2.5 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500/30 focus:border-blue-400 outline-none transition-all",placeholder:"Enter segment name",autoFocus:!0})]})})},me=()=>{const{segments:s,createCustomerSegment:r,fetchSegmentsByStoreId:a,updateCustomerSegmentName:n,loading:o,error:i}=Y(),{activeStoreId:c}=G(),[h,b]=t.useState(!1),[u,w]=t.useState(""),[A,p]=t.useState(!1),[g,v]=t.useState(""),[f,L]=t.useState(""),[y,_]=t.useState("desc"),[m,D]=t.useState(""),C=H(),d=t.useMemo(()=>c||"",[c]),j=t.useMemo(()=>[...s].sort((x,N)=>{const E=new Date(x.createdAt).getTime(),M=new Date(N.createdAt).getTime();return y==="asc"?E-M:M-E}),[s,y]),k=t.useMemo(()=>{if(!m.trim())return j;const l=m.toLowerCase();return j.filter(x=>x.name.toLowerCase().includes(l))},[j,m]);t.useEffect(()=>{d&&a(d).catch(()=>{})},[d,a]);const B=t.useCallback(async()=>{if(!(!u.trim()||!d))try{await r(d,u.trim()),w(""),b(!1)}catch{}},[u,d,r]),P=t.useCallback(async()=>{if(!(!g.trim()||!f))try{await n(f,g.trim()),p(!1)}catch{}},[g,f,n]),S=t.useCallback(()=>b(!0),[]),W=t.useCallback(()=>b(!1),[]),F=t.useCallback((l,x)=>{L(l),v(x),p(!0)},[]),q=t.useCallback(()=>p(!1),[]),z=t.useCallback(l=>C(`/customers/segments/${l}`),[C]),V=t.useCallback((l,x,N)=>{l.stopPropagation(),F(x,N)},[F]),X=t.useCallback(()=>{_(l=>l==="asc"?"desc":"asc")},[]);return e.jsxs("div",{className:"min-h-screen bg-page-background-color",children:[e.jsxs("div",{className:"max-w-[1400px] mx-auto px-3 sm:px-4 py-4",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 tracking-tight",children:"Customer segments"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Organize customers into groups for targeted marketing and reporting"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(O,{to:"/customers",className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(R,{className:"w-4 h-4"}),"View customers"]}),e.jsxs("button",{type:"button",onClick:S,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx($,{className:"w-4 h-4"}),"Create segment"]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-6",children:[e.jsx("div",{className:"bg-white rounded-xl border border-gray-200/80 p-5 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total segments"}),e.jsx("p",{className:"mt-1 text-2xl font-bold text-gray-900",children:s.length})]}),e.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-50 flex items-center justify-center",children:e.jsx(I,{className:"w-5 h-5 text-blue-600"})})]})}),e.jsx(O,{to:"/customers",className:"bg-white rounded-xl border border-gray-200/80 p-5 shadow-sm hover:border-blue-200 transition-colors block",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Customers"}),e.jsx("p",{className:"mt-1 text-base font-medium text-blue-600 hover:text-blue-700",children:"Manage customers â†’"})]}),e.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-50 flex items-center justify-center",children:e.jsx(R,{className:"w-5 h-5 text-blue-600"})})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200/80 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"px-5 py-4 border-b border-gray-100 flex flex-col sm:flex-row sm:items-center gap-4",children:e.jsxs("div",{className:"relative flex-1",children:[e.jsx(J,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search segments by name...",value:m,onChange:l=>D(l.target.value),className:"w-full pl-10 pr-4 py-2.5 text-sm border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-500/30 focus:border-blue-400 outline-none transition-all"})]})}),o?e.jsxs("div",{className:"py-24 flex flex-col items-center justify-center",children:[e.jsx("div",{className:"w-10 h-10 rounded-full border-2 border-gray-200 border-t-blue-600 animate-spin"}),e.jsx("p",{className:"mt-4 text-sm text-gray-500",children:"Loading segments..."})]}):i?e.jsxs("div",{className:"py-24 flex flex-col items-center justify-center",children:[e.jsx("p",{className:"text-sm text-red-600",children:i}),d&&e.jsx("button",{type:"button",onClick:()=>a(d),className:"mt-4 text-sm font-medium text-gray-900 hover:underline",children:"Retry"})]}):k.length===0?e.jsxs("div",{className:"py-24 flex flex-col items-center justify-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-gray-100 flex items-center justify-center mb-4",children:e.jsx(I,{className:"w-8 h-8 text-gray-400"})}),e.jsx("p",{className:"text-base font-medium text-gray-900",children:m?"No segments match your search":"No segments yet"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:m?"Try a different search term.":"Create segments to group customers for marketing, reporting, or targeted campaigns."}),!m&&e.jsxs("button",{type:"button",onClick:S,className:"mt-6 inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx($,{className:"w-4 h-4"}),"Create segment"]})]}):e.jsx(se,{segments:k,sortOrder:y,onSortToggle:X,onSegmentClick:z,onEditClick:V})]})]}),e.jsx(ee,{isOpen:h,name:u,storeId:d,onNameChange:w,onClose:W,onCreate:B}),e.jsx(ae,{isOpen:A,editName:g,onNameChange:v,onClose:q,onSave:P})]})};export{me as default};
