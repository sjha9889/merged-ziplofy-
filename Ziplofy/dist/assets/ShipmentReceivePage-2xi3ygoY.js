import{u as W,p as R,w as k,v as q,r as x,j as t}from"./index-C7S6h9OR.js";import{G as I}from"./GridBackgroundWrapper-Du1VLjut.js";import{B as p,T as c}from"./Box-Cgm3ZkZ8.js";import{P as T}from"./Paper-DocVmpOE.js";import{T as z,a as G,b as H,c as N,d as i,e as L}from"./TableRow-Bdpb2Dqq.js";import{S as V}from"./Stack-CYPs5YkO.js";import{A as $}from"./Avatar-DBcC4tVz.js";import{T as w}from"./TextField-CwtyivJh.js";import{B}from"./Button-CdPvNkrY.js";import"./DefaultPropsProvider-CZkfTDs_.js";import"./createSvgIcon-Yi9Vo0kN.js";import"./Select-Bus390RW.js";import"./index-CCB_rw4P.js";const it=()=>{const u=W(),{id:h}=R(),{shipmentId:j}=R(),{entries:g,fetchByTransferId:b,loading:C}=k(),{receiveShipment:S,loading:M}=q();x.useEffect(()=>{h&&b(h).catch(()=>{})},[h,b]);const[o,_]=x.useState({}),[f,v]=x.useState({}),E=(e,a)=>r=>{const s=Number(r.target.value??0),d=Math.max(0,Math.min(a,isNaN(s)?0:s));_(n=>({...n,[e]:d})),v(n=>{const l=n[e]??0,m=Math.max(0,a-d),y=Math.max(0,Math.min(m,l));return y===l?n:{...n,[e]:y}})},A=(e,a)=>r=>{const s=Number(r.target.value??0),d=o[e]??0,n=Math.max(0,a-d),l=Math.max(0,Math.min(n,isNaN(s)?0:s));v(m=>({...m,[e]:l}))},P=async()=>{if(!j)return;const e=g.map(a=>({entryId:a._id,accept:Number(o[a._id]||0),reject:Number(f[a._id]||0)}));await S(j,e),u("/products/transfers")};return t.jsx(I,{children:t.jsx(p,{sx:{width:"100%",color:"#000000",m:-3,p:3,minHeight:"100%"},children:t.jsxs(p,{sx:{maxWidth:1200,mx:"auto"},children:[t.jsxs(T,{elevation:0,sx:{p:4,mb:4,borderRadius:3,background:"linear-gradient(135deg, #0ea5e9 0%, #6366f1 100%)",color:"white"},children:[t.jsx(c,{variant:"h4",sx:{fontWeight:800,mb:1},children:"Receive Shipment"}),t.jsx(c,{variant:"body1",sx:{opacity:.9},children:"Control how much you want to accept or reject per variant."})]}),t.jsxs(T,{elevation:0,sx:{p:3,borderRadius:3,border:"1px solid #e5e7eb",bgcolor:"white"},children:[C?t.jsx(c,{variant:"body2",color:"text.secondary",children:"Loading entries..."}):t.jsx(z,{children:t.jsxs(G,{size:"small",children:[t.jsx(H,{children:t.jsxs(N,{children:[t.jsx(i,{children:"Product"}),t.jsx(i,{children:"Variant"}),t.jsx(i,{align:"right",children:"Transferred Qty"}),t.jsx(i,{align:"right",children:"Accept"}),t.jsx(i,{align:"right",children:"Reject"})]})}),t.jsx(L,{children:g.map(e=>t.jsxs(N,{hover:!0,children:[t.jsx(i,{children:t.jsxs(V,{direction:"row",spacing:1,alignItems:"center",children:[t.jsx($,{variant:"rounded",src:e.variantId.images?.[0]||void 0,sx:{width:36,height:36}}),t.jsx(c,{variant:"body2",fontWeight:700,children:e.variantId.productName||"Unnamed product"})]})}),t.jsx(i,{children:t.jsx(c,{variant:"caption",color:"text.secondary",children:Object.entries(e.variantId.optionValues||{}).map(([a,r])=>`${a}: ${r}`).join(" â€¢ ")})}),t.jsx(i,{align:"right",sx:{fontWeight:700},children:e.quantity}),t.jsx(i,{align:"right",sx:{minWidth:140},children:t.jsx(w,{size:"small",type:"number",inputProps:{min:0,max:e.quantity},value:o[e._id]??"",onChange:E(e._id,Number(e.quantity)||0)})}),t.jsx(i,{align:"right",sx:{minWidth:140},children:t.jsx(w,{size:"small",type:"number",inputProps:{min:0,max:Math.max(0,(Number(e.quantity)||0)-(o[e._id]??0))},value:f[e._id]??"",onChange:A(e._id,Number(e.quantity)||0)})})]},e._id))})]})}),t.jsxs(p,{sx:{display:"flex",justifyContent:"flex-end",gap:1,mt:3},children:[t.jsx(B,{variant:"text",onClick:()=>u(-1),children:"Cancel"}),t.jsx(B,{variant:"contained",onClick:P,disabled:M,children:"Save"})]})]})]})})})};export{it as default};
