import{r as o,R as ne,p as Je,b as Ge,u as Ye,j as c}from"./index-C7S6h9OR.js";function Oe(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Qe(e){if(Array.isArray(e))return e}function Ze(e,t,r){return(t=st(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function et(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,s,a,f,x=[],w=!0,j=!1;try{if(a=(r=r.call(e)).next,t!==0)for(;!(w=(n=a.call(r)).done)&&(x.push(n.value),x.length!==t);w=!0);}catch(F){j=!0,s=F}finally{try{if(!w&&r.return!=null&&(f=r.return(),Object(f)!==f))return}finally{if(j)throw s}}return x}}function tt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Re(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function $e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Re(Object(r),!0).forEach(function(n){Ze(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Re(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rt(e,t){if(e==null)return{};var r,n,s=nt(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function nt(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function ot(e,t){return Qe(e)||et(e,t)||at(e,t)||tt()}function it(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function st(e){var t=it(e,"string");return typeof t=="symbol"?t:t+""}function at(e,t){if(e){if(typeof e=="string")return Oe(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Oe(e,t):void 0}}function ct(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ie(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Ce(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ie(Object(r),!0).forEach(function(n){ct(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ie(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function lt(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(n){return t.reduceRight(function(s,a){return a(s)},n)}}function se(e){return function t(){for(var r=this,n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return s.length>=e.length?e.apply(this,s):function(){for(var f=arguments.length,x=new Array(f),w=0;w<f;w++)x[w]=arguments[w];return t.apply(r,[].concat(s,x))}}}function fe(e){return{}.toString.call(e).includes("Object")}function ut(e){return!Object.keys(e).length}function ce(e){return typeof e=="function"}function dt(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function ft(e,t){return fe(t)||B("changeType"),Object.keys(t).some(function(r){return!dt(e,r)})&&B("changeField"),t}function pt(e){ce(e)||B("selectorType")}function ht(e){ce(e)||fe(e)||B("handlerType"),fe(e)&&Object.values(e).some(function(t){return!ce(t)})&&B("handlersType")}function gt(e){e||B("initialIsRequired"),fe(e)||B("initialType"),ut(e)&&B("initialContent")}function mt(e,t){throw new Error(e[t]||e.default)}var vt={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},B=se(mt)(vt),ue={changes:ft,selector:pt,handler:ht,initial:gt};function xt(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};ue.initial(e),ue.handler(t);var r={current:e},n=se(wt)(r,t),s=se(bt)(r),a=se(ue.changes)(e),f=se(yt)(r);function x(){var j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(F){return F};return ue.selector(j),j(r.current)}function w(j){lt(n,s,a,f)(j)}return[x,w]}function yt(e,t){return ce(t)?t(e.current):t}function bt(e,t){return e.current=Ce(Ce({},e.current),t),t}function wt(e,t,r){return ce(t)?t(e.current):Object.keys(r).forEach(function(n){var s;return(s=t[n])===null||s===void 0?void 0:s.call(t,e.current[n])}),r}var jt={create:xt},St={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.55.1/min/vs"}};function Et(e){return function t(){for(var r=this,n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return s.length>=e.length?e.apply(this,s):function(){for(var f=arguments.length,x=new Array(f),w=0;w<f;w++)x[w]=arguments[w];return t.apply(r,[].concat(s,x))}}}function Mt(e){return{}.toString.call(e).includes("Object")}function Ot(e){return e||Pe("configIsRequired"),Mt(e)||Pe("configType"),e.urls?(Rt(),{paths:{vs:e.urls.monacoBase}}):e}function Rt(){console.warn(ke.deprecation)}function $t(e,t){throw new Error(e[t]||e.default)}var ke={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},Pe=Et($t)(ke),It={config:Ot},Ct=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return function(s){return r.reduceRight(function(a,f){return f(a)},s)}};function Fe(e,t){return Object.keys(t).forEach(function(r){t[r]instanceof Object&&e[r]&&Object.assign(t[r],Fe(e[r],t[r]))}),$e($e({},e),t)}var Pt={type:"cancelation",msg:"operation is manually canceled"};function he(e){var t=!1,r=new Promise(function(n,s){e.then(function(a){return t?s(Pt):n(a)}),e.catch(s)});return r.cancel=function(){return t=!0},r}var Lt=["monaco"],kt=jt.create({config:St,isInitialized:!1,resolve:null,reject:null,monaco:null}),Te=ot(kt,2),le=Te[0],pe=Te[1];function Ft(e){var t=It.config(e),r=t.monaco,n=rt(t,Lt);pe(function(s){return{config:Fe(s.config,n),monaco:r}})}function Tt(){var e=le(function(t){var r=t.monaco,n=t.isInitialized,s=t.resolve;return{monaco:r,isInitialized:n,resolve:s}});if(!e.isInitialized){if(pe({isInitialized:!0}),e.monaco)return e.resolve(e.monaco),he(ge);if(window.monaco&&window.monaco.editor)return De(window.monaco),e.resolve(window.monaco),he(ge);Ct(Dt,zt)(At)}return he(ge)}function Dt(e){return document.body.appendChild(e)}function Wt(e){var t=document.createElement("script");return e&&(t.src=e),t}function zt(e){var t=le(function(n){var s=n.config,a=n.reject;return{config:s,reject:a}}),r=Wt("".concat(t.config.paths.vs,"/loader.js"));return r.onload=function(){return e()},r.onerror=t.reject,r}function At(){var e=le(function(r){var n=r.config,s=r.resolve,a=r.reject;return{config:n,resolve:s,reject:a}}),t=window.require;t.config(e.config),t(["vs/editor/editor.main"],function(r){var n=r.m||r;De(n),e.resolve(n)},function(r){e.reject(r)})}function De(e){le().monaco||pe({monaco:e})}function Ut(){return le(function(e){var t=e.monaco;return t})}var ge=new Promise(function(e,t){return pe({resolve:e,reject:t})}),We={config:Ft,init:Tt,__getMonacoInstance:Ut},Bt={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},me=Bt,Nt={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},Ht=Nt;function Vt({children:e}){return ne.createElement("div",{style:Ht.container},e)}var qt=Vt,Kt=qt;function _t({width:e,height:t,isEditorReady:r,loading:n,_ref:s,className:a,wrapperProps:f}){return ne.createElement("section",{style:{...me.wrapper,width:e,height:t},...f},!r&&ne.createElement(Kt,null,n),ne.createElement("div",{ref:s,style:{...me.fullWidth,...!r&&me.hide},className:a}))}var Xt=_t,ze=o.memo(Xt);function Jt(e){o.useEffect(e,[])}var Ae=Jt;function Gt(e,t,r=!0){let n=o.useRef(!0);o.useEffect(n.current||!r?()=>{n.current=!1}:e,t)}var C=Gt;function ae(){}function re(e,t,r,n){return Yt(e,n)||Qt(e,t,r,n)}function Yt(e,t){return e.editor.getModel(Ue(e,t))}function Qt(e,t,r,n){return e.editor.createModel(t,r,n?Ue(e,n):void 0)}function Ue(e,t){return e.Uri.parse(t)}function Zt({original:e,modified:t,language:r,originalLanguage:n,modifiedLanguage:s,originalModelPath:a,modifiedModelPath:f,keepCurrentOriginalModel:x=!1,keepCurrentModifiedModel:w=!1,theme:j="light",loading:F="Loading...",options:P={},height:N="100%",width:_="100%",className:X,wrapperProps:J={},beforeMount:G=ae,onMount:Y=ae}){let[I,H]=o.useState(!1),[A,b]=o.useState(!0),S=o.useRef(null),y=o.useRef(null),W=o.useRef(null),O=o.useRef(Y),p=o.useRef(G),T=o.useRef(!1);Ae(()=>{let h=We.init();return h.then(E=>(y.current=E)&&b(!1)).catch(E=>E?.type!=="cancelation"&&console.error("Monaco initialization: error:",E)),()=>S.current?z():h.cancel()}),C(()=>{if(S.current&&y.current){let h=S.current.getOriginalEditor(),E=re(y.current,e||"",n||r||"text",a||"");E!==h.getModel()&&h.setModel(E)}},[a],I),C(()=>{if(S.current&&y.current){let h=S.current.getModifiedEditor(),E=re(y.current,t||"",s||r||"text",f||"");E!==h.getModel()&&h.setModel(E)}},[f],I),C(()=>{let h=S.current.getModifiedEditor();h.getOption(y.current.editor.EditorOption.readOnly)?h.setValue(t||""):t!==h.getValue()&&(h.executeEdits("",[{range:h.getModel().getFullModelRange(),text:t||"",forceMoveMarkers:!0}]),h.pushUndoStop())},[t],I),C(()=>{S.current?.getModel()?.original.setValue(e||"")},[e],I),C(()=>{let{original:h,modified:E}=S.current.getModel();y.current.editor.setModelLanguage(h,n||r||"text"),y.current.editor.setModelLanguage(E,s||r||"text")},[r,n,s],I),C(()=>{y.current?.editor.setTheme(j)},[j],I),C(()=>{S.current?.updateOptions(P)},[P],I);let Q=o.useCallback(()=>{if(!y.current)return;p.current(y.current);let h=re(y.current,e||"",n||r||"text",a||""),E=re(y.current,t||"",s||r||"text",f||"");S.current?.setModel({original:h,modified:E})},[r,t,s,e,n,a,f]),V=o.useCallback(()=>{!T.current&&W.current&&(S.current=y.current.editor.createDiffEditor(W.current,{automaticLayout:!0,...P}),Q(),y.current?.editor.setTheme(j),H(!0),T.current=!0)},[P,j,Q]);o.useEffect(()=>{I&&O.current(S.current,y.current)},[I]),o.useEffect(()=>{!A&&!I&&V()},[A,I,V]);function z(){let h=S.current?.getModel();x||h?.original?.dispose(),w||h?.modified?.dispose(),S.current?.dispose()}return ne.createElement(ze,{width:_,height:N,isEditorReady:I,loading:F,_ref:W,className:X,wrapperProps:J})}var er=Zt;o.memo(er);function tr(e){let t=o.useRef();return o.useEffect(()=>{t.current=e},[e]),t.current}var rr=tr,de=new Map;function nr({defaultValue:e,defaultLanguage:t,defaultPath:r,value:n,language:s,path:a,theme:f="light",line:x,loading:w="Loading...",options:j={},overrideServices:F={},saveViewState:P=!0,keepCurrentModel:N=!1,width:_="100%",height:X="100%",className:J,wrapperProps:G={},beforeMount:Y=ae,onMount:I=ae,onChange:H,onValidate:A=ae}){let[b,S]=o.useState(!1),[y,W]=o.useState(!0),O=o.useRef(null),p=o.useRef(null),T=o.useRef(null),Q=o.useRef(I),V=o.useRef(Y),z=o.useRef(),h=o.useRef(n),E=rr(a),R=o.useRef(!1),q=o.useRef(!1);Ae(()=>{let $=We.init();return $.then(m=>(O.current=m)&&W(!1)).catch(m=>m?.type!=="cancelation"&&console.error("Monaco initialization: error:",m)),()=>p.current?Z():$.cancel()}),C(()=>{let $=re(O.current,e||n||"",t||s||"",a||r||"");$!==p.current?.getModel()&&(P&&de.set(E,p.current?.saveViewState()),p.current?.setModel($),P&&p.current?.restoreViewState(de.get(a)))},[a],b),C(()=>{p.current?.updateOptions(j)},[j],b),C(()=>{!p.current||n===void 0||(p.current.getOption(O.current.editor.EditorOption.readOnly)?p.current.setValue(n):n!==p.current.getValue()&&(q.current=!0,p.current.executeEdits("",[{range:p.current.getModel().getFullModelRange(),text:n,forceMoveMarkers:!0}]),p.current.pushUndoStop(),q.current=!1))},[n],b),C(()=>{let $=p.current?.getModel();$&&s&&O.current?.editor.setModelLanguage($,s)},[s],b),C(()=>{x!==void 0&&p.current?.revealLine(x)},[x],b),C(()=>{O.current?.editor.setTheme(f)},[f],b);let oe=o.useCallback(()=>{if(!(!T.current||!O.current)&&!R.current){V.current(O.current);let $=a||r,m=re(O.current,n||e||"",t||s||"",$||"");p.current=O.current?.editor.create(T.current,{model:m,automaticLayout:!0,...j},F),P&&p.current.restoreViewState(de.get($)),O.current.editor.setTheme(f),x!==void 0&&p.current.revealLine(x),S(!0),R.current=!0}},[e,t,r,n,s,a,j,F,P,f,x]);o.useEffect(()=>{b&&Q.current(p.current,O.current)},[b]),o.useEffect(()=>{!y&&!b&&oe()},[y,b,oe]),h.current=n,o.useEffect(()=>{b&&H&&(z.current?.dispose(),z.current=p.current?.onDidChangeModelContent($=>{q.current||H(p.current.getValue(),$)}))},[b,H]),o.useEffect(()=>{if(b){let $=O.current.editor.onDidChangeMarkers(m=>{let K=p.current.getModel()?.uri;if(K&&m.find(U=>U.path===K.path)){let U=O.current.editor.getModelMarkers({resource:K});A?.(U)}});return()=>{$?.dispose()}}return()=>{}},[b,A]);function Z(){z.current?.dispose(),N?P&&de.set(a,p.current.saveViewState()):p.current.getModel()?.dispose(),p.current.dispose()}return ne.createElement(ze,{width:_,height:X,isEditorReady:b,loading:w,_ref:T,className:J,wrapperProps:G})}var or=nr,ir=o.memo(or),sr=ir;const Le=["index.html","assets/css/style.css","assets/js/script.js"],cr=({fullScreen:e=!1})=>{const{themeId:t=""}=Je(),{activeStoreId:r}=Ge(),[n,s]=o.useState("index.html"),[a,f]=o.useState({}),[x,w]=o.useState(Le),[j,F]=o.useState(""),P=Ye(),[N,_]=o.useState(!0),[X,J]=o.useState(null),[G,Y]=o.useState(null),[I,H]=o.useState(new Set),[A,b]=o.useState(null),S=o.useRef(null),y=o.useRef(null),W=o.useRef(null),[O,p]=o.useState(280),[T,Q]=o.useState(420),[V,z]=o.useState(!1),[h,E]=o.useState(!1),[R,q]=o.useState(null),oe=R==="explorer",Z=R==="editor",$=R==="preview",m=o.useMemo(()=>"https://backend.ziplofy.com/api",[]),K=o.useMemo(()=>`${m}/themes/preview/${t}`,[m,t]),[U,ve]=o.useState(!1),[xe,Be]=o.useState(null),[ye,ee]=o.useState(null),te=o.useCallback(()=>typeof window>"u"?"":localStorage.getItem("accessToken")||sessionStorage.getItem("accessToken")||localStorage.getItem("token")||sessionStorage.getItem("token")||localStorage.getItem("authToken")||sessionStorage.getItem("authToken")||"",[]),D=o.useCallback(()=>{const i=te();return i?{Authorization:`Bearer ${i}`}:{}},[te]),be=o.useMemo(()=>!!te(),[te]),we=o.useCallback(()=>{const i=te();if(!i)return"";try{const u=i.split(".");if(u.length<2)return"";const l=JSON.parse(atob(u[1].replace(/-/g,"+").replace(/_/g,"/")));return String(l.uid||l.userId||l.id||"")}catch{return""}},[te]),je=o.useMemo(()=>{if(r)return`${m}/themes/installed/${r}/${t}/unzippedTheme/`;const i=we();return i?`${m}/themes/installed/${i}/${t}/unzippedTheme/`:""},[m,t,r,we]),Ne=o.useCallback(async()=>{if(!t||!n){ee("No file selected to save.");return}if(!be){ee("Login required to save.");return}if(!r){ee("Please select a store before saving.");return}const i=a[n]??"";!i&&i!==""&&console.warn("Warning: Saving empty content"),ve(!0),ee(null);try{const u={"Content-Type":"application/json",...D()},l={path:n,content:i,storeId:r};console.log("ðŸ’¾ Saving file:",{themeId:t,path:n,storeId:r,contentLength:i.length});const g=await fetch(`${m}/themes/${t}/save-edit`,{method:"POST",headers:u,credentials:"include",body:JSON.stringify(l)});if(!g.ok){const d=await g.text().catch(()=>"")||`Save failed with status ${g.status}`;throw console.error("âŒ Save failed:",d),new Error(d)}const v=await g.json().catch(()=>({}));if(v.success!==!1)console.log("âœ… File saved successfully:",{themeId:t,path:n,storeId:r}),Be(new Date),ee(null);else throw new Error(v.error||v.message||"Save failed")}catch(u){const l=u?.message||"Failed to save file";console.error("âŒ Save error:",l),ee(l)}finally{ve(!1)}},[m,t,n,a,D,be,r]);o.useEffect(()=>{let i=!1;async function u(){try{_(!0),J(null),console.log(`ðŸ”„ Store changed, clearing file cache. New storeId: ${r||"none"}`),f({});try{const d=r?`?storeId=${encodeURIComponent(r)}`:"",L=await fetch(`${m}/themes/files/${t}${d}`,{credentials:"include",headers:D()});if(L.ok){const k=await L.json();k?.files?.length&&w(k.files)}}catch{}try{const d=await fetch(`${m}/themes/${t}`,{credentials:"include",headers:D()});if(d.ok){const L=await d.json(),k=L?.data?.name||L?.name||"Theme";i||F(k)}}catch{}const l=r?`&storeId=${encodeURIComponent(r)}`:"";console.log(`ðŸ“‚ Loading files for storeId: ${r||"none (user-specific)"}`);const[g,v,M]=await Promise.all([fetch(`${m}/themes/file/${t}?path=${encodeURIComponent("index.html")}${l}`,{credentials:"include",headers:D()}).then(d=>d.ok?d.text():""),fetch(`${m}/themes/file/${t}?path=${encodeURIComponent("assets/css/style.css")}${l}`,{credentials:"include",headers:D()}).then(d=>d.ok?d.text():""),fetch(`${m}/themes/file/${t}?path=${encodeURIComponent("assets/js/script.js")}${l}`,{credentials:"include",headers:D()}).then(d=>d.ok?d.text():"")]);if(i)return;f(d=>({...d,"index.html":g,"assets/css/style.css":v,"assets/js/script.js":M})),s("index.html")}catch(l){J(l?.message||"Failed to load theme files")}finally{_(!1)}}return u(),()=>{i=!0}},[K,r,m,t,D]),o.useEffect(()=>{async function i(u){if(a[u]===void 0)try{Y(u);const l=r?`&storeId=${encodeURIComponent(r)}`:"",g=await fetch(`${m}/themes/file/${t}?path=${encodeURIComponent(u)}${l}`,{credentials:"include",headers:D()});if(g.ok){const v=await g.text();f(M=>({...M,[u]:v}))}}catch{}finally{Y(l=>l===u?null:l)}}n&&!Le.includes(n)&&i(n)},[n,m,t,a,r,D]);const Se=o.useCallback(()=>{const i=a["index.html"]||"",u=a["assets/js/script.js"]||"";let l=i.replace(/<base[^>]*>/gi,"").replace(/<script[\s\S]*?<\/script>/gi,"");const g=l.includes("</head>")?l:l.replace(/<html[^>]*>/i,"$&<head></head>"),v=je||`${K}/`;return g.replace(/<head>/i,`<head><base href="${v}">`).replace(/<\/body>/i,`${u?`<script type="module" src="${v}assets/js/script.js"><\/script>`:""}</body>`)},[a,K,je]);o.useEffect(()=>{if(!S.current)return;const i=S.current.contentDocument;i&&(i.open(),i.write(Se()),i.close())},[a,Se]),o.useEffect(()=>{const i=u=>{if((navigator.platform.toUpperCase().indexOf("MAC")>=0?u.metaKey:u.ctrlKey)&&(u.key==="f"||u.key==="F")){u.preventDefault();try{y.current?.focus?.(),y.current?.trigger?.("keyboard","actions.find",null)}catch{}}};return window.addEventListener("keydown",i,{capture:!0}),()=>window.removeEventListener("keydown",i,{capture:!0})},[]),o.useEffect(()=>{const i=l=>{if(!W.current)return;const g=W.current.getBoundingClientRect(),v=180,M=280,d=300,L=g.width;if(V){const k=l.clientX-g.left,ie=Math.max(v,Math.min(k,L-T-d));p(ie)}else if(h){const k=g.right-l.clientX,ie=Math.max(M,Math.min(k,L-O-d));Q(ie)}},u=()=>{z(!1),E(!1)};return window.addEventListener("mousemove",i),window.addEventListener("mouseup",u),()=>{window.removeEventListener("mousemove",i),window.removeEventListener("mouseup",u)}},[V,h,O,T]);const He=i=>{typeof i=="string"&&f(u=>({...u,[n]:i}))},Ve=o.useMemo(()=>{const i=n.toLowerCase();return i.endsWith(".html")||i.endsWith(".htm")?"html":i.endsWith(".css")?"css":i.endsWith(".js")||i.endsWith(".mjs")||i.endsWith(".cjs")?"javascript":i.endsWith(".json")?"json":i.endsWith(".ts")||i.endsWith(".tsx")?"typescript":i.endsWith(".jsx")?"javascript":i.endsWith(".md")?"markdown":"plaintext"},[n]),Ee=o.useMemo(()=>{const i=n.toLowerCase();return/\.(html?|css|js|mjs|cjs|json|ts|tsx|jsx|md|txt|svg|xml|yml|yaml|env|ini|cfg|conf)$/i.test(i)},[n]),qe=o.useMemo(()=>{const i={};return x.forEach(u=>{const l=u.split("/");let g=i;for(let v=0;v<l.length;v++){const M=l[v],d=v===l.length-1;g[M]||(g[M]=d?{type:"file",path:u}:{type:"folder",children:{}}),d||(g=g[M].children)}}),i},[x]),Ke=i=>{H(u=>{const l=new Set(u);return l.has(i)?l.delete(i):l.add(i),l})},Me=(i,u="",l=0)=>{const g=[];return Object.entries(i).forEach(([v,M])=>{if(v==="files")return;const d=u?`${u}/${v}`:v,L=I.has(d);if(M.type==="folder")g.push(c.jsxs("div",{children:[c.jsxs("div",{onClick:()=>Ke(d),onMouseEnter:()=>b(d),onMouseLeave:()=>b(null),style:{display:"flex",alignItems:"center",padding:"4px 8px",paddingLeft:`${8+l*16}px`,cursor:"pointer",fontSize:"13px",color:"#8B949E",backgroundColor:A===d?"#21262D":"transparent",borderRadius:"3px",margin:"1px 0"},children:[c.jsx("span",{style:{marginRight:"6px",fontSize:"12px"},children:L?"ðŸ“‚":"ðŸ“"}),v]}),L&&c.jsx("div",{children:Me(M.children,d,l+1)})]},d));else{const k=n===M.path,ie=G===M.path,Xe=A===M.path;g.push(c.jsxs("div",{onClick:()=>s(M.path),onMouseEnter:()=>b(M.path),onMouseLeave:()=>b(null),style:{display:"flex",alignItems:"center",padding:"4px 8px",paddingLeft:`${8+l*16}px`,cursor:"pointer",fontSize:"13px",color:k?"#FFFFFF":"#8B949E",backgroundColor:k?"#0969DA":Xe?"#21262D":"transparent",borderRadius:"3px",margin:"1px 0"},children:[c.jsx("span",{style:{marginRight:"6px",fontSize:"12px"},children:_e(v)}),v,ie&&c.jsx("span",{style:{marginLeft:"6px",fontSize:"11px",color:"#6b7280"},children:"(loading)"})]},M.path))}}),g},_e=i=>{switch(i.split(".").pop()?.toLowerCase()){case"html":case"htm":return"ðŸŒ";case"css":return"ðŸŽ¨";case"js":case"mjs":case"cjs":return"ðŸ“œ";case"ts":case"tsx":return"ðŸ”·";case"jsx":return"âš›ï¸";case"json":return"ðŸ“‹";case"md":return"ðŸ“";case"png":case"jpg":case"jpeg":case"gif":case"svg":return"ðŸ–¼ï¸";case"txt":return"ðŸ“„";default:return"ðŸ“„"}};return c.jsxs("div",{style:{display:"flex",flexDirection:"column",height:e?"100vh":"calc(100vh - 60px)",gap:8},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:8,padding:"6px 8px"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[c.jsx("button",{onClick:()=>{P("/themes/all-themes")},style:{border:"1px solid #d1d5da",background:"#fff",color:"#111827",padding:"6px 10px",borderRadius:6,cursor:"pointer"},children:"â† Back"}),c.jsx("div",{style:{fontWeight:700,fontSize:16},children:j?`Editing Code: ${j}`:"Editing Code"})]}),c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[ye&&c.jsx("span",{style:{color:"#dc2626",fontSize:12},children:ye}),U&&c.jsx("span",{style:{color:"#6b7280",fontSize:12},children:"ðŸ’¾ Savingâ€¦"}),!U&&xe&&c.jsxs("span",{style:{color:"#6b7280",fontSize:12},children:["âœ“ Saved ",xe.toLocaleTimeString()]}),c.jsx("button",{onClick:Ne,disabled:U,style:{border:"1px solid #10b981",background:"#10b981",color:"#ffffff",padding:"6px 12px",borderRadius:6,cursor:U?"not-allowed":"pointer",fontWeight:700},children:"Save"})]})]}),c.jsxs("div",{ref:W,style:{display:"flex",gap:0,flex:1,minHeight:0,position:"relative",overflow:"hidden"},children:[c.jsxs("div",{style:{flex:oe?"1 1 auto":`0 0 ${Z||$?0:O}px`,minWidth:0,borderRight:"1px solid #30363D",backgroundColor:"#161B22",color:"#F0F6FC",display:"flex",flexDirection:"column",transition:"flex-basis 120ms ease",overflow:"hidden"},children:[c.jsx("div",{style:{padding:"12px 16px",borderBottom:"1px solid #30363D",fontWeight:600,fontSize:"13px",color:"#F0F6FC"},children:c.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:8},children:[c.jsx("span",{children:"EXPLORER"}),c.jsx("div",{style:{display:"flex",gap:6},children:c.jsx("button",{onClick:()=>q(R==="explorer"?null:"explorer"),title:R==="explorer"?"Restore layout":"Expand Explorer",style:{border:"1px solid #30363D",background:"#0D1117",color:"#E6EDF3",padding:"2px 6px",borderRadius:4,cursor:"pointer",fontSize:12},children:R==="explorer"?"Restore":"Expand"})})]})}),c.jsx("div",{style:{flex:1,overflow:"auto",padding:"8px 0"},children:Me(qe)})]}),R===null&&c.jsx("div",{onMouseDown:()=>z(!0),style:{width:8,cursor:"col-resize",background:"#0d1117",borderRight:"1px solid #30363D",borderLeft:"1px solid #0b0f14"}}),c.jsxs("div",{style:{flex:Z?"1 1 auto":R?"0 0 0px":"1 1 auto",minWidth:0,display:"flex",flexDirection:"column",transition:"flex-basis 120ms ease",overflow:R&&!Z?"hidden":"initial"},children:[c.jsx("div",{style:{padding:"6px 8px",borderBottom:"1px solid #e5e7eb",fontWeight:600},children:n}),c.jsxs("div",{style:{flex:1,minHeight:300},children:[!N&&Ee&&c.jsx(sr,{height:"100%",language:Ve,theme:"vs-dark",value:a[n]??(G===n?"":a[n]??""),onChange:He,onMount:i=>{y.current=i},options:{fontSize:14,minimap:{enabled:!1}}}),!N&&!Ee&&c.jsx("div",{style:{padding:12,color:"#6b7280"},children:"Preview not available for this file type. Select a text file to edit."}),N&&c.jsx("div",{style:{padding:12},children:"Loading filesâ€¦"}),X&&c.jsx("div",{style:{padding:12,color:"#dc2626"},children:X})]}),c.jsx("div",{style:{padding:"6px 8px",borderTop:"1px solid #e5e7eb",display:"flex",justifyContent:"flex-end"},children:c.jsx("button",{onClick:()=>q(R==="editor"?null:"editor"),title:R==="editor"?"Restore layout":"Expand Editor",style:{border:"1px solid #d1d5da",background:"#fff",color:"#111827",padding:"4px 8px",borderRadius:6,cursor:"pointer",fontWeight:600},children:R==="editor"?"Restore":"Expand"})})]}),R===null&&c.jsx("div",{onMouseDown:()=>E(!0),style:{width:6,cursor:"col-resize",background:"transparent"}}),c.jsxs("div",{style:{flex:$?"1 1 auto":`0 0 ${oe||Z?0:T}px`,minWidth:0,borderLeft:"1px solid #e5e7eb",display:"flex",flexDirection:"column",transition:"flex-basis 120ms ease",overflow:"hidden"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:8,padding:"6px 8px",borderBottom:"1px solid #e5e7eb"},children:[c.jsx("div",{style:{fontWeight:600},children:"Preview"}),!e&&c.jsx("button",{onClick:()=>window.open(`/themes/code-fullscreen/${t}`,"_blank","noopener,noreferrer"),style:{border:"1px solid #d1d5da",background:"#fff",color:"#111827",padding:"6px 10px",borderRadius:6,cursor:"pointer",fontWeight:600},children:"Edit in new tab"}),c.jsx("button",{onClick:()=>{z(!1),E(!1),q(i=>i==="preview"?null:"preview")},title:R==="preview"?"Restore layout":"Expand Preview",style:{border:"1px solid #d1d5da",background:"#fff",color:"#111827",padding:"6px 10px",borderRadius:6,cursor:"pointer",fontWeight:600},children:R==="preview"?"Restore":"Expand"})]}),c.jsx("iframe",{ref:S,style:{flex:1,border:0,background:"#fff"},title:"Theme Preview"})]})]})]})};export{cr as default};
