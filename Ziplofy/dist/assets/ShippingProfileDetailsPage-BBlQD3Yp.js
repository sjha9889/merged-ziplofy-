import{u as rr,p as ar,d as nr,b as ir,$ as or,a3 as lr,a4 as cr,a5 as dr,a2 as ur,a6 as xr,a7 as mr,r as i,j as e,F as Xt,x as gr,Y as es,g as ts,M as pr}from"./index-C7S6h9OR.js";import{G as Ne}from"./GridBackgroundWrapper-Du1VLjut.js";import{M as v}from"./Modal-DsfhGJdg.js";import{F as hr}from"./ArrowLeftIcon-C1qOxHB_.js";import{F as fr}from"./PencilIcon-MufFKs4H.js";import{F as yr}from"./TrashIcon-B2-WJkmb.js";import{F as ss}from"./ExclamationTriangleIcon-C8O-WV1K.js";import{F as rs}from"./EllipsisHorizontalIcon-CCX74wqb.js";import{F as br}from"./TruckIcon-BgeMuXfC.js";import"./index-CCB_rw4P.js";const Mr=()=>{const ve=rr(),{profileId:l}=ar(),{searchProductsWithVariants:nt}=nr(),{activeStoreId:h}=ir(),{storeCountries:it,getCountriesByStoreId:ot}=or(),{statesByCountry:p,getStatesByCountryId:Se}=lr(),{createShippingZone:as,updateShippingZone:ns,deleteShippingZone:is,getShippingZonesByShippingProfileId:H,shippingZones:u,loading:J}=cr(),{createShippingZoneRate:os,getShippingZoneRatesByZoneId:lt,updateShippingZoneRate:ls,deleteShippingZoneRate:cs,loading:ct}=dr(),{shippingProfiles:dt,getShippingProfilesByStoreId:ut,updateShippingProfile:ds,deleteShippingProfile:us,loading:xt}=ur(),{settingsByProfileId:Q,fetchByProfileId:mt,updateLocationSetting:xs,loading:ms,error:gt}=xr(),{entriesByProfileId:pt,fetchByProfileId:ht,addEntry:ft,deleteEntry:we}=mr(),[Ce,F]=i.useState({}),[gs,yt]=i.useState({}),[M,bt]=i.useState(!1),[ps,ke]=i.useState(!1),[jr,hs]=i.useState({}),[Re,fs]=i.useState({}),[X,ys]=i.useState(new Set),Pe=()=>{ve("/settings/shipping-and-delivery")},[f,jt]=i.useState({});i.useEffect(()=>{l&&(Q[l]||mt(l).catch(()=>{}))},[l,Q,mt]);const Nt=i.useCallback(t=>t?[t?.address,t?.apartment,t?.city,t?.state,t?.postalCode].filter(r=>typeof r=="string"&&r.trim().length>0).map(r=>String(r).trim()).join(", "):"",[]),Ie=i.useMemo(()=>l?(Q[l]||[]).reduce((s,r)=>{const a=r.location,n=typeof r.locationId=="string"?r.locationId:r.locationId?._id||r.locationId,o=n?String(n).trim():"";return o&&s.push({id:o,name:a?.name||"Untitled location",address:Nt(a),country:a?.countryRegion||"",raw:a,contextSetting:{createNewRates:r.createNewRates,removeRates:r.removeRates}}),s},[]):[],[l,Q,Nt]),[E,vt]=i.useState(!1),[_e,St]=i.useState(""),[Fe,wt]=i.useState(""),[bs,Ct]=i.useState(!1),[kt,Z]=i.useState(null),[Me,L]=i.useState([]),[Rt,Pt]=i.useState(null),[js,It]=i.useState(new Set),[Ns,_t]=i.useState(new Set),[S,A]=i.useState(null),[vs,D]=i.useState(!1),[R,Ee]=i.useState(""),[Ze,Ft]=i.useState(!1),[z,ee]=i.useState(""),[Le,Ae]=i.useState(""),[y,V]=i.useState(new Set),[B,w]=i.useState(new Set),[Ss,te]=i.useState(new Set),[ws,De]=i.useState(!1),[Mt,se]=i.useState(null),[Et,C]=i.useState(null),[Zt,ze]=i.useState(new Set),Lt=i.useRef(y),[Cs,re]=i.useState(!1),[P,At]=i.useState(null),[ae,Ve]=i.useState("create"),T=i.useRef("create"),[Be,Te]=i.useState(null),[ne,ie]=i.useState(null),[oe,Dt]=i.useState(!1),[O,Oe]=i.useState(null),[ks,We]=i.useState(!1),[I,$e]=i.useState(null),[W,Ue]=i.useState(null),[$,le]=i.useState("flat"),[zt,Ge]=i.useState("custom"),[ce,Ke]=i.useState(""),[Vt,Ye]=i.useState(""),[de,ue]=i.useState("0.00"),[k,xe]=i.useState(!1),[j,U]=i.useState("weight"),[Bt,me]=i.useState("0"),[Tt,ge]=i.useState(""),[Ot,pe]=i.useState("0.00"),[Wt,he]=i.useState(""),[b,qe]=i.useState(null),[G,fe]=i.useState(null),[ye,$t]=i.useState(!1),[Rs,He]=i.useState(null),[Ps,be]=i.useState(!1),[je,Ut]=i.useState(!1),Is=["Tracking number provided","Made to order","Ships next day"],Je=O?._id?String(O._id):null,{reservedStatesMap:_s,reservedCountriesMap:Gt}=i.useMemo(()=>{const t=new Map,s=new Map;return Array.isArray(u)&&u.forEach(r=>{if(!r||Je&&String(r._id)===Je)return;const a=r.zoneName||"Another zone";(r.countries||[]).forEach(n=>{if(!n)return;const o=n.countryId?String(n.countryId):"";o&&(Array.isArray(n.stateIds)&&n.stateIds.length>0?n.stateIds.forEach(c=>{c&&t.set(String(c),a)}):s.set(o,a))})}),{reservedStatesMap:t,reservedCountriesMap:s}},[u,Je]),Kt=i.useMemo(()=>{const t=it??[],s=Le.trim().toLowerCase();return s?t.filter(r=>[r.name,r.officialName,r.iso2,r.iso3,r.numericCode].filter(Boolean).map(n=>String(n).toLowerCase()).some(n=>n.includes(s))).sort((r,a)=>r.name.localeCompare(a.name)):[...t].sort((r,a)=>r.name.localeCompare(a.name))},[it,Le]),Qe=i.useCallback(async t=>{if(!t)return[];const s=p[t];if(s)return s;ze(r=>{const a=new Set(r);return a.add(t),a});try{return await Se(t)||[]}catch{return[]}finally{ze(r=>{const a=new Set(r);return a.delete(t),a})}},[Se,p]);i.useEffect(()=>{h&&(bt(!0),ut(h).catch(t=>{console.error("Failed to fetch shipping profiles:",t)}).finally(()=>bt(!1)))},[h,ut]),i.useEffect(()=>{l&&ht(l).catch(()=>{})},[l,ht]);const x=i.useMemo(()=>{if(l)return dt.find(t=>t._id===l)},[dt,l]);i.useEffect(()=>{if(!E)return;const t=setTimeout(()=>{wt(_e)},300);return()=>clearTimeout(t)},[E,_e]),i.useEffect(()=>{Lt.current=y},[y]),i.useEffect(()=>{if(!E)return;if(!Fe.trim()){L([]),Pt(null),Z(null);return}if(!h){Z("Select a store to manage products."),L([]);return}let t=!1;return(async()=>{try{Ct(!0),Z(null);const r=await nt({storeId:h,q:Fe,limit:50});if(t)return;L(r.data||[]),Pt(r.pagination||null)}catch(r){if(t)return;L([]);const a=r?.message||"Failed to search products";Z(a)}finally{t||Ct(!1)}})(),()=>{t=!0}},[E,h,Fe,nt]),i.useEffect(()=>{if(!Ze)return;if(!h){se("Select a store to manage shipping zones."),De(!1);return}let t=!1;return(async()=>{try{De(!0),se(null),await ot(h)}catch(r){if(t)return;const a=r?.message||"Failed to fetch countries";se(a)}finally{t||De(!1)}})(),()=>{t=!0}},[Ze,h,ot]),i.useEffect(()=>{l&&H(l).catch(t=>{console.error("Failed to fetch shipping zones:",t)})},[l,H]),i.useEffect(()=>{if(!u||u.length===0)return;(async()=>{for(const s of u)if(s._id){yt(r=>r[s._id]?r:{...r,[s._id]:!0});try{const r=await lt(s._id);F(a=>a[s._id]?a:{...a,[s._id]:r})}catch(r){console.error(`Failed to fetch rates for zone ${s._id}:`,r),F(a=>a[s._id]?a:{...a,[s._id]:[]})}finally{yt(r=>({...r,[s._id]:!1}))}}})()},[u,lt]);const Xe=()=>{le("flat"),Ge("custom"),Ke(""),Ye(""),ue("0.00"),xe(!1),U("weight"),me("0"),ge(""),pe("0.00"),he("")},Fs=t=>{le(t.rateType||"flat"),Ge(t.shippingRate||"custom"),Ke(t.customRateName||""),Ye(t.customDeliveryDescription||"");const s=typeof t.price=="number"?t.price:parseFloat(String(t.price??0));ue(Number.isFinite(s)?s.toFixed(2):"0.00");const r=!!t.conditionalPricingEnabled;xe(r),U(r&&t.conditionalPricingBasis==="price"?"price":"weight"),me(t.minWeight===null||t.minWeight===void 0?"":String(t.minWeight)),ge(t.maxWeight===null||t.maxWeight===void 0?"":String(t.maxWeight)),pe(t.minPrice===null||t.minPrice===void 0?"":String(t.minPrice)),he(t.maxPrice===null||t.maxPrice===void 0?"":String(t.maxPrice))},et=()=>{We(!1),$e(null),Ue(null),Xe()},Ms=t=>{t&&(Xe(),$e(t),Ue(null),We(!0))},Es=()=>{if(!b)return;const t=u.find(s=>s._id===b.zoneId)||{_id:b.zoneId};Xe(),Fs(b.rate),$e(t),Ue(b.rate._id),We(!0),qe(null)},Zs=async()=>{if(!b)return;const{zoneId:t,zoneName:s,rate:r}=b;qe(null),fe({zoneId:t,zoneName:s,rate:r})},Ls=t=>{He(t.currentTarget)},As=()=>{He(null)},Ds=async()=>{if(l){Ut(!0);try{await us(l),be(!1),He(null),ve("/settings/shipping-and-delivery")}catch{}finally{Ut(!1)}}},zs=async()=>{if(ne){Dt(!0);try{await is(ne.id),ie(null)}catch(t){console.error("Failed to delete shipping zone:",t)}finally{Dt(!1)}}},Vs=async()=>{if(!G)return;$t(!0);const{zoneId:t,rate:s}=G;try{await cs(s._id),F(r=>{const a=r[t]||[];return{...r,[t]:a.filter(n=>n._id!==s._id)}}),fe(null)}catch(r){console.error("Failed to delete shipping zone rate:",r)}finally{$t(!1)}},Bs=async()=>{if(!I)return;const t={rateType:$,shippingRate:zt||"custom",customRateName:ce.trim(),customDeliveryDescription:Vt.trim()||void 0,price:de,conditionalPricingEnabled:k,conditionalPricingBasis:k?j:void 0,minWeight:k&&j==="weight"&&Bt||void 0,maxWeight:k&&j==="weight"&&Tt||void 0,minPrice:k&&j==="price"&&Ot||void 0,maxPrice:k&&j==="price"&&Wt||void 0};try{if(W){const s=await ls(W,t);F(r=>{const a=I._id,n=r[a]||[];return{...r,[a]:n.map(o=>o._id===W?s:o)}})}else{const s={...t,shippingZoneId:I._id},r=await os(s);I._id&&F(a=>({...a,[I._id]:[r,...a[I._id]||[]]}))}et()}catch(s){console.error("Failed to save shipping zone rate:",s)}},Ts=()=>{vt(!0),St(""),wt(""),L([]),Z(null)},tt=()=>{vt(!1)},Yt=async t=>{if(Oe(null),ee(""),V(new Set),w(new Set),te(new Set),Ae(""),se(null),C(null),ze(new Set),Ft(!0),t){Oe(t),ee(t.zoneName||"");const s=new Set,r=new Set;if(t.countries&&Array.isArray(t.countries))for(const a of t.countries){if(s.add(a.countryId),!p[a.countryId])try{await Se(a.countryId)}catch(n){console.error(`Failed to fetch states for country ${a.countryId}:`,n)}a.stateIds&&Array.isArray(a.stateIds)&&a.stateIds.forEach(n=>{r.add(n)})}V(s),w(r),te(new Set)}},st=()=>{Ft(!1),Oe(null),ee(""),Ae(""),V(new Set),w(new Set),te(new Set),C(null)},Os=async()=>{if(!l){C("Shipping profile ID is required");return}if(!z.trim()){C("Zone name is required");return}if(Ht===0){C("Please select at least one country or state");return}try{C(null);const t=[];for(const a of y){const o=(p[a]||[]).filter(c=>B.has(c._id));o.length>0?t.push({countryId:a,stateIds:o.map(c=>c._id)}):t.push({countryId:a})}const s=new Map;Object.entries(p).forEach(([a,n])=>{n.forEach(o=>{s.set(o._id,a)})});const r=[];for(const a of B){const n=s.get(a);n&&!y.has(n)&&r.push(a)}if(r.length>0){const a=new Map;r.forEach(n=>{const o=s.get(n);o&&(a.has(o)||a.set(o,[]),a.get(o).push(n))}),a.forEach((n,o)=>{t.push({countryId:o,stateIds:n})})}O?(await ns(O._id,{zoneName:z.trim(),countries:t}),l&&await H(l)):(await as({zoneName:z.trim(),shippingProfileId:l,countries:t}),l&&await H(l)),st()}catch(t){const s=t?.message||"Failed to create shipping zone";C(s)}},Ws=t=>{At(t);const s=String(t.id).trim(),r=f[s]||t.contextSetting;let a="create";r&&(a=r.removeRates?"remove":"create"),T.current=a,Ve(a),re(!0)},qt=()=>{re(!1),At(null)},$s=async()=>{if(!P||!l)return;const t=String(P.id).trim();if(!t||t.length===0){console.error("Invalid locationId:",P.id);return}const s=T.current,r=s==="create",a=s==="remove";console.log("Saving location settings:",{locationId:t,currentSelection:s,stateValue:ae,refValue:T.current,createNewRates:r,removeRates:a});const n=f[t]||P.contextSetting,o=n?n.createNewRates:!0,c=n?n.removeRates:!1;if(!(r!==o||a!==c)){re(!1);return}try{await xs(l,t,{createNewRates:r,removeRates:a}),jt(d=>({...d,[t]:{createNewRates:r,removeRates:a}})),hs(d=>({...d,[t]:!0}))}catch(d){console.error("Failed to update location setting:",d)}finally{re(!1)}},Us=t=>{const s=Object.values(t.optionValues||{});return s.length===0?t.sku:s.join(" / ")},Gs=()=>bs?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"w-6 h-6 border-2 border-gray-300 border-t-gray-900 rounded-full animate-spin"})}):kt?e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 text-xs",children:kt}):Me.length?e.jsxs("div",{className:"border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center px-3 py-2 bg-gray-50 border-b border-gray-200",children:[e.jsx("p",{className:"flex-1 text-xs font-medium text-gray-600",children:"Product"}),e.jsx("p",{className:"w-40 text-right text-xs font-medium text-gray-600",children:"Profile"})]}),e.jsx("div",{children:Me.map(t=>{const s=t.variants.every(n=>_.has(n._id)),r=!s&&t.variants.some(n=>_.has(n._id)),a=Ns.has(t.product._id);return e.jsxs("div",{className:"border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-3 px-3 py-2",children:[e.jsx("input",{type:"checkbox",checked:s,ref:n=>{n&&(n.indeterminate=r)},onChange:()=>qs(t,s),disabled:a,className:"w-4 h-4 text-gray-900 border-gray-300 focus:ring-gray-400 disabled:opacity-50"}),e.jsx("div",{className:"w-9 h-9 bg-gray-100 flex items-center justify-center text-xs font-medium text-gray-600 shrink-0",children:t.product.imageUrl?e.jsx("img",{src:t.product.imageUrl,alt:t.product.title,className:"w-full h-full object-cover"}):t.product.title?.charAt(0).toUpperCase()||"P"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:t.product.title}),e.jsx("p",{className:"text-xs text-gray-600",children:t.product.sku||"No SKU"})]}),e.jsx("p",{className:"w-40 text-right text-sm text-gray-600",children:"General shipping"})]}),t.variants.map(n=>{const o=_.has(n._id),c=js.has(n._id)||a;return e.jsxs("div",{className:"flex items-center gap-3 px-3 py-1 pl-12",children:[e.jsx("input",{type:"checkbox",checked:o,onChange:()=>Ys(n),disabled:c,className:"w-4 h-4 text-gray-900 border-gray-300 focus:ring-gray-400 disabled:opacity-50"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-gray-900",children:Us(n)}),e.jsxs("p",{className:"text-xs text-gray-600",children:["SKU: ",n.sku]})]}),e.jsx("p",{className:"w-40 text-right text-sm text-gray-600",children:"General shipping"})]},n._id)})]},t.product._id)})})]}):e.jsx("div",{className:"py-12 text-center",children:e.jsx("p",{className:"text-sm text-gray-600",children:"No products found."})}),K=i.useMemo(()=>l?pt[l]||[]:[],[l,pt]),Ks=K.length,_=i.useMemo(()=>{const t=new Map;return K.forEach(s=>{const r=typeof s.productVariantId=="string"?s.productVariantId:s.productVariantId?._id;r&&t.set(String(r),s)}),t},[K]),Ys=async t=>{if(!l)return;const s=t._id;It(r=>new Set(r).add(s));try{const r=_.get(s);r?await we(r._id,l):await ft(l,{productVariantId:s})}catch(r){console.error("Failed to toggle product variant entry:",r)}finally{It(r=>{const a=new Set(r);return a.delete(s),a})}},qs=async(t,s)=>{if(!l)return;const r=t.product._id;_t(a=>new Set(a).add(r));try{if(s){const a=t.variants.map(n=>_.get(n._id)).filter(n=>!!n);for(const n of a)await we(n._id,l)}else{const a=t.variants.filter(n=>!_.has(n._id));for(const n of a)await ft(l,{productVariantId:n._id})}}catch(a){console.error("Failed to toggle product variants:",a)}finally{_t(a=>{const n=new Set(a);return n.delete(r),n})}},Hs=t=>{const s=t._id,r=y.has(s);if(V(a=>{const n=new Set(a);return r?n.delete(s):n.add(s),n}),r){const a=p[s];a?.length&&w(n=>{const o=new Set(n);return a.forEach(c=>o.delete(c._id)),o})}else{const a=p[s];a?.length?w(n=>{const o=new Set(n);return a.forEach(c=>o.add(c._id)),o}):Qe(s).then(n=>{n?.length&&Lt.current.has(s)&&w(o=>{const c=new Set(o);return n.forEach(g=>c.add(g._id)),c})})}},Js=i.useCallback(t=>{te(s=>{const r=new Set(s);return r.has(t._id)?r.delete(t._id):(r.add(t._id),Qe(t._id)),r})},[Qe]),Qs=i.useCallback((t,s)=>{w(r=>{const a=new Set(r);a.has(s._id)?a.delete(s._id):a.add(s._id);const n=p[t._id]||[];if(n.length){const o=n.every(c=>a.has(c._id));V(c=>{const g=new Set(c);return o?g.add(t._id):g.delete(t._id),g})}return a})},[p]),Xs=t=>{if(Zt.has(t._id))return"Loading states...";const s=p[t._id];if(Array.isArray(s)){const r=s.length;return`${s.filter(o=>B.has(o._id)).length} of ${r} ${r===1?"state":"states"}`}return y.has(t._id)?"Selected":""},er=()=>Kt.length?e.jsx("div",{className:"border border-gray-200 overflow-hidden",children:Kt.map(t=>{const s=String(t._id??t.countryId??t.id??""),r=y.has(t._id),a=Xs(t),n=t.flagEmoji||t.iso2?.toUpperCase()||"??",o=p[t._id],c=Ss.has(t._id),d=!!(s&&Gt.get(s));return e.jsxs("div",{className:"border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-3 px-3 py-2",children:[e.jsx("input",{type:"checkbox",checked:r,onChange:()=>Hs(t),disabled:d,className:"w-4 h-4 text-gray-900 border-gray-300 focus:ring-gray-400 disabled:opacity-50"}),e.jsx("div",{className:"w-8 h-8 flex items-center justify-center text-base",children:n}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:t.name}),d?e.jsx("p",{className:"text-xs text-gray-400 font-medium",children:"In another zone"}):a?e.jsx("p",{className:"text-xs text-gray-600",children:a}):null]}),e.jsx("button",{onClick:()=>Js(t),className:"p-1 text-gray-500 hover:text-gray-700 transition-colors",children:c?e.jsx(pr,{className:"w-4 h-4"}):e.jsx(Xt,{className:"w-4 h-4"})})]}),c&&e.jsx("div",{className:"pl-12 pr-3 pb-2",children:Zt.has(t._id)?e.jsxs("div",{className:"flex items-center gap-2 py-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-gray-900 rounded-full animate-spin"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Loading states..."})]}):o&&o.length>0?e.jsx("div",{className:"space-y-1",children:o.map(m=>{const N=String(m._id),at=B.has(m._id),q=!!(Gt.get(s)||(N?_s.get(N):void 0));return e.jsxs("div",{className:"flex items-center gap-2 py-1",children:[e.jsx("input",{type:"checkbox",checked:at&&!q,onChange:()=>Qs(t,m),disabled:q,className:"w-4 h-4 text-gray-900 border-gray-300 focus:ring-gray-400 disabled:opacity-50"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:`text-sm ${q?"text-gray-400":"text-gray-900"}`,children:m.name}),!q&&m.code&&e.jsx("p",{className:"text-xs text-gray-600",children:m.code})]}),q&&e.jsx("p",{className:"text-xs text-gray-400 font-medium",children:"In another zone"})]},m._id)})}):e.jsx("p",{className:"text-xs text-gray-600 py-2",children:"No states available"})})]},t._id)})}):e.jsx("div",{className:"border border-gray-200 py-12 text-center",children:e.jsx("p",{className:"text-sm text-gray-600",children:"No countries available. Add countries to your markets to see them here."})}),Ht=y.size+B.size,tr=x?.profileName||"Shipping profile";i.useEffect(()=>{x?.profileName!==void 0&&Ee(x.profileName)},[x?.profileName]);const Y=i.useRef(!1),Jt=i.useRef(void 0),[rt,Qt]=i.useState(!1);i.useEffect(()=>{l!==Jt.current&&(Y.current=!1,Qt(!1),Jt.current=l)},[l]),i.useEffect(()=>{if(!(!x||!l||M)&&!Y.current&&!rt){if(x.locationSettings&&x.locationSettings.length>0){const t={};x.locationSettings.forEach(s=>{const r=String(s.locationId).trim();r&&r.length>0&&(t[r]={createNewRates:s.createNewRates,removeRates:s.removeRates})}),console.log("Populated locationSettings from profile:",t),jt(t)}Qt(!0)}},[l,x,M]),i.useEffect(()=>{if(!x||!l||M||Y.current||!rt)return;const t=setTimeout(()=>{fs({...f}),ys(new Set(u.map(s=>s._id))),Y.current=!0},100);return()=>clearTimeout(t)},[l,x,M,rt,u.length]),i.useEffect(()=>{if(!Y.current){Object.keys(f).length===0&&u.length===0&&ke(!1);return}const t=(()=>{const a=Object.keys(f),n=Object.keys(Re);if(a.length!==n.length)return!0;for(const o of a){const c=f[o],g=Re[o];if(!g||c.createNewRates!==g.createNewRates||c.removeRates!==g.removeRates)return!0}for(const o of n)if(!f[o])return!0;return!1})(),s=u.length!==X.size||u.some(a=>!X.has(a._id))||Array.from(X).some(a=>!u.find(n=>n._id===a)),r=R.trim()!==(x?.profileName||"").trim();ke(r||t||s)},[f,u,R,x?.profileName,Re,X]);const sr=async()=>{if(!l)return;const t=R.trim();if(!t){Ee(x?.profileName||"Shipping profile"),D(!1);return}try{await ds(l,{profileName:t}),ke(!1),D(!1)}catch(s){console.error("Failed to update shipping profile:",s)}};return l?M&&!x?e.jsx(Ne,{children:e.jsx("div",{className:"max-w-7xl mx-auto py-8 px-4",children:e.jsx("div",{className:"text-center py-12",children:e.jsx("div",{className:"inline-block w-6 h-6 border-2 border-gray-300 border-t-gray-900 rounded-full animate-spin"})})})}):x?e.jsxs(Ne,{children:[e.jsxs("div",{className:"max-w-7xl mx-auto py-8 px-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 border-b border-gray-200 pb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:Pe,className:"p-1 text-gray-600 hover:text-gray-900 transition-colors",children:e.jsx(hr,{className:"w-5 h-5"})}),vs?e.jsx("input",{type:"text",value:R,onChange:t=>Ee(t.target.value),autoFocus:!0,onBlur:()=>D(!1),onKeyDown:t=>{t.key==="Enter"&&(t.preventDefault(),D(!1))},className:"text-xl font-medium text-gray-900 border-b border-gray-300 focus:outline-none focus:border-gray-900 min-w-[200px]"}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h1",{className:"text-xl font-medium text-gray-900",children:R}),e.jsx("button",{onClick:()=>D(!0),className:"p-1 text-gray-500 hover:text-gray-700 transition-colors",children:e.jsx(fr,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:Ls,className:"px-3 py-1.5 text-sm font-medium border border-gray-200 text-gray-700 hover:bg-gray-50 transition-colors flex items-center gap-1",children:["Actions",e.jsx(Xt,{className:"w-4 h-4"})]}),Rs&&e.jsx("div",{className:"absolute right-0 top-full mt-1 bg-white border border-gray-200 z-10 min-w-[150px]",children:e.jsx("button",{onClick:()=>{be(!0),As()},className:"w-full px-3 py-2 text-left text-xs text-red-600 hover:bg-gray-50 transition-colors font-medium",children:"Delete profile"})})]}),(ps||R.trim()!==(x?.profileName||"").trim())&&e.jsx("button",{onClick:sr,disabled:xt,className:"px-3 py-1.5 text-sm font-medium border border-gray-200 text-gray-700 min-w-[100px] disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50 transition-colors",children:xt?"Saving...":"Save"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"border border-gray-200 bg-white/95 p-4",children:[e.jsx("h2",{className:"text-sm font-medium text-gray-900 mb-3",children:"Products"}),e.jsxs("button",{onClick:Ts,className:"px-3 py-1.5 text-xs font-medium border border-gray-200 text-gray-700 hover:bg-gray-50 transition-colors flex items-center gap-2",children:[e.jsx(gr,{className:"w-4 h-4"}),"Add products"]}),K.length===0?e.jsx("p",{className:"text-sm text-gray-600 mt-3",children:"No products selected yet."}):e.jsxs("div",{className:"mt-3 border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"bg-gray-50 border-b border-gray-200 px-3 py-2",children:e.jsxs("p",{className:"text-xs font-medium text-gray-700",children:["Selected (",Ks,")"]})}),e.jsx("div",{className:"p-3 space-y-2",children:K.map(t=>{const s=typeof t.productVariantId=="string"?{_id:t.productVariantId}:t.productVariantId,r=s&&typeof s.productId=="object"?s.productId:null,a=s?.optionValues?Object.values(s.optionValues).filter(Boolean).join(" / "):s?.sku||"Variant",n=r?.imageUrls&&r.imageUrls.length>0?r.imageUrls[0]:void 0;return e.jsx("div",{children:e.jsxs("div",{className:"flex items-center gap-2 border border-gray-100 p-2",children:[e.jsx("div",{className:"w-8 h-8 bg-purple-50 flex items-center justify-center text-xs font-medium text-purple-900 shrink-0",children:n?e.jsx("img",{src:n,alt:r?.title||"Product",className:"w-full h-full object-cover"}):a?.charAt(0).toUpperCase()||"P"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:r?.title||"Product"}),e.jsx("p",{className:"text-xs text-gray-600 truncate",children:a})]}),e.jsx("button",{onClick:()=>A(t),className:"p-1 text-red-600 hover:text-red-700 transition-colors",children:e.jsx(yr,{className:"w-4 h-4"})})]})},t._id)})})]})]}),e.jsxs("div",{className:"border border-gray-200 bg-white/95 p-4",children:[e.jsx("h2",{className:"text-sm font-medium text-gray-900 mb-3",children:"Fulfillment locations"}),ms?e.jsx("div",{className:"py-8 text-center",children:e.jsx("div",{className:"inline-block w-6 h-6 border-2 border-gray-300 border-t-gray-900 rounded-full animate-spin"})}):gt?e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 text-xs",children:gt}):Ie.length===0?e.jsx("p",{className:"text-sm text-gray-600",children:"No fulfillment locations available for this profile."}):e.jsx("div",{className:"space-y-3",children:Ie.map((t,s)=>{const r=String(t.id).trim(),a=f[r]||t.contextSetting,n=a?a.createNewRates:!0;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-start gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:t.name}),t.country&&e.jsx("p",{className:"text-sm text-gray-600",children:t.country}),t.address&&e.jsx("p",{className:"text-sm text-gray-600 mt-0.5",children:t.address}),e.jsx("div",{className:"mt-1",children:n?e.jsx("span",{className:"inline-block px-2 py-0.5 text-xs font-medium bg-green-50 text-green-700",children:"Creating new rates"}):e.jsx("span",{className:"inline-block px-2 py-0.5 text-xs font-medium bg-red-50 text-red-700",children:"Rates removed for this profile"})})]}),e.jsx("button",{onClick:()=>Ws(t),className:"px-2 py-1 text-xs font-medium text-gray-700 hover:text-gray-900 transition-colors",children:"Edit"})]}),s<Ie.length-1&&e.jsx("div",{className:"border-t border-gray-200 my-3"})]},t.id)})}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h2",{className:"text-sm font-medium text-gray-900",children:"Shipping zones"}),e.jsx("button",{onClick:()=>Yt(),className:"text-xs text-gray-600 hover:text-gray-900 underline",children:"Add shipping zone"})]}),J?e.jsx("div",{className:"py-8 text-center",children:e.jsx("div",{className:"inline-block w-6 h-6 border-2 border-gray-300 border-t-gray-900 rounded-full animate-spin"})}):u.length===0?e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 text-yellow-800 px-4 py-3 text-xs mb-3 flex items-start gap-2",children:[e.jsx(ss,{className:"w-4 h-4 mt-0.5 shrink-0"}),e.jsx("span",{children:"Add a zone and rate to ship from these locations"})]}):e.jsx("div",{className:"space-y-3",children:u.map(t=>{const s=t.countries?.[0],r=t.countries?.length>1,a=s?.countryName||"Unknown",n=s?.countryFlag||"",o=s?.selectedStatesCount||0,c=s?.totalStatesCount||0,g=o>0;return e.jsxs("div",{children:[e.jsx("div",{className:"border border-gray-200 p-3 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex items-center gap-3",children:[n&&e.jsx("div",{className:"w-8 h-8 flex items-center justify-center text-base",children:n}),e.jsx("div",{className:"flex-1",children:e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[t.zoneName,r?e.jsxs("span",{className:"text-sm text-gray-600 ml-1",children:["• ",t.countries.length," countries"]}):e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-sm text-gray-600 ml-1",children:["• ",a]}),g&&e.jsxs("span",{className:"text-sm text-gray-600 ml-1",children:["(",o," of ",c," ",c===1?"state":"states",")"]})]})]})}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:d=>Te({element:d.currentTarget,zoneId:t._id}),className:"p-1 text-gray-500 hover:text-gray-700 transition-colors",children:e.jsx(rs,{className:"w-5 h-5"})}),Be?.zoneId===t._id&&e.jsxs("div",{className:"absolute right-0 top-full mt-1 bg-white border border-gray-200 z-10 min-w-[120px]",children:[e.jsx("button",{onClick:()=>{const d=u.find(m=>m._id===Be?.zoneId);Te(null),d&&Yt(d)},className:"w-full px-3 py-2 text-left text-xs text-gray-700 hover:bg-gray-50 transition-colors",children:"Edit"}),e.jsx("button",{onClick:()=>{const d=Be?.zoneId;if(Te(null),!d)return;const m=u.find(N=>N._id===d);ie({id:d,name:m?.zoneName||"this"})},className:"w-full px-3 py-2 text-left text-xs text-red-600 hover:bg-gray-50 transition-colors",children:"Delete"})]})]})]})}),gs[t._id]?e.jsx("div",{className:"py-3 text-center",children:e.jsx("div",{className:"inline-block w-5 h-5 border-2 border-gray-300 border-t-gray-900 rounded-full animate-spin"})}):Ce[t._id]&&Ce[t._id].length>0?e.jsx("div",{className:"mt-2 space-y-1",children:Ce[t._id].map(d=>{const m=typeof d.price=="number"?d.price:parseFloat(String(d.price)),N=Number.isFinite(m)?m:0;return e.jsxs("div",{className:"border border-gray-200 p-2 flex items-center justify-between",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:d.customRateName}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-0.5 text-xs font-medium ${N===0?"bg-green-100 text-green-700":"bg-blue-100 text-blue-700"}`,children:N===0?"Free":`₹${N.toFixed(2)}`}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:at=>qe({element:at.currentTarget,zoneId:t._id,zoneName:t.zoneName,rate:d}),className:"p-1 text-gray-500 hover:text-gray-700 transition-colors",children:e.jsx(rs,{className:"w-4 h-4"})}),b?.zoneId===t._id&&b?.rate._id===d._id&&e.jsxs("div",{className:"absolute right-0 top-full mt-1 bg-white border border-gray-200 z-10 min-w-[120px]",children:[e.jsx("button",{onClick:Es,className:"w-full px-3 py-2 text-left text-xs text-gray-700 hover:bg-gray-50 transition-colors",children:"Edit rate"}),e.jsx("button",{onClick:Zs,className:"w-full px-3 py-2 text-left text-xs text-red-600 hover:bg-gray-50 transition-colors",children:"Delete"})]})]})]})]},d._id)})}):e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 text-yellow-800 px-4 py-3 text-xs mt-2 flex items-start gap-2",children:[e.jsx(ss,{className:"w-4 h-4 mt-0.5 shrink-0"}),e.jsx("span",{children:"No rates. Customers in this zone won't be able to complete checkout."})]}),e.jsxs("button",{onClick:()=>Ms(t),className:"text-xs text-gray-600 hover:text-gray-900 mt-2 flex items-center gap-1",children:[e.jsx(br,{className:"w-4 h-4"}),"Add rate"]})]},t._id)})})]})]}),e.jsxs("div",{className:"border border-gray-200 bg-white/95 p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h2",{className:"text-sm font-medium text-gray-900",children:"Start shipping to more places"}),e.jsx("span",{className:"px-1.5 py-0.5 text-xs font-medium bg-gray-100 text-gray-900",children:"i"})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Add countries/regions to a market to start selling and manage localized settings, including shipping zones"}),e.jsx("button",{onClick:()=>ve("/markets"),className:"px-3 py-1.5 text-xs font-medium border border-gray-200 text-gray-700 hover:bg-gray-50 transition-colors",children:"Go to Markets"}),e.jsx(es,{to:"/settings/markets",className:"block mt-3 text-xs text-gray-600 hover:text-gray-900",children:"233 countries/regions not in a market"})]})]})]}),e.jsx(v,{open:E,onClose:tt,maxWidth:"md",title:"Manage products",actions:e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:tt,className:"px-3 py-1.5 text-xs font-medium border border-gray-200 text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:tt,className:"px-3 py-1.5 text-xs font-medium border border-gray-200 text-gray-700 hover:bg-gray-50 transition-colors",children:"Done"})]}),children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("input",{type:"text",value:_e,onChange:t=>St(t.target.value),placeholder:"Search products",className:"w-full px-3 py-1.5 text-sm border border-gray-200 focus:outline-none focus:ring-1 focus:ring-gray-400"}),e.jsx(ts,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"})]}),e.jsx("select",{value:"all",disabled:!0,className:"px-3 py-1.5 text-sm border border-gray-200 focus:outline-none focus:ring-1 focus:ring-gray-400 w-[180px] bg-gray-50",children:e.jsx("option",{value:"all",children:"Search by All"})})]}),e.jsx("button",{disabled:!0,className:"px-3 py-1.5 text-xs font-medium border border-gray-200 text-gray-400 w-[120px] disabled:opacity-50 disabled:cursor-not-allowed",children:"Add filter +"}),Rt&&e.jsxs("p",{className:"text-xs text-gray-600",children:["Showing ",Me.length," of ",Rt.total," products"]}),Gs()]})}),e.jsx(v,{open:!!S,onClose:()=>A(null),maxWidth:"sm",title:"Remove Variant?",actions:e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>A(null),className:"px-3 py-1.5 text-xs font-medium border border-gray-200 text-gray-700 hover:bg-gray-50 transition-colors",children:"No"}),e.jsx("button",{onClick:()=>{S&&l?we(S._id,l).finally(()=>{A(null)}):A(null)},className:"px-3 py-1.5 text-xs font-medium border border-gray-200 text-gray-700 hover:bg-gray-50 transition-colors",children:"Yes"})]}),children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Are you sure you want to delete this product variant from"," ",e.jsx("span",{className:"font-medium text-gray-900",children:tr})," ","shipping profile?"]}),S&&e.jsx("p",{className:"text-sm font-medium text-gray-900 mt-2",children:(()=>{const t=typeof S.productVariantId=="string"?null:S.productVariantId;if(!t)return String(S.productVariantId);const s=t&&typeof t.productId=="object"?t.productId:null,r=t.optionValues?Object.values(t.optionValues).filter(Boolean).join(" / "):t.sku;return`${s?.title||"Product"} • ${r||"Variant"}`})()})]})}),e.jsx(v,{open:Cs,onClose:qt,maxWidth:"sm",title:`Manage rates for ${P?.name||"location"}`,actions:e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:qt,className:"px-3 py-1.5 text-xs font-medium border border-gray-200 text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:$s,disabled:!ae,className:"px-3 py-1.5 text-xs font-medium border border-gray-200 text-gray-700 hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Done"})]}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 mb-2",children:"Create new rates"}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",value:"create",checked:ae==="create",onChange:t=>{const s=t.target.value;T.current=s,Ve(s)},className:"w-4 h-4 text-gray-900 border-gray-300 focus:ring-gray-400"}),e.jsxs("span",{className:"text-sm text-gray-700",children:["New rate for ",P?.name||"this location"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 mb-2",children:"Remove rates"}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",value:"remove",checked:ae==="remove",onChange:t=>{const s=t.target.value;T.current=s,Ve(s)},className:"w-4 h-4 text-gray-900 border-gray-300 focus:ring-gray-400"}),e.jsx("span",{className:"text-sm text-gray-700",children:"This location will no longer ship the products in this profile"})]})]})]})}),e.jsx(v,{open:Ze,onClose:st,maxWidth:"md",title:O?"Edit shipping zone":"Create new shipping zone",actions:e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:st,disabled:J,className:"px-3 py-1.5 text-xs font-medium border border-gray-200 text-gray-700 hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),Et&&e.jsx("span",{className:"text-xs text-red-600 mr-2",children:Et}),e.jsx("button",{onClick:Os,disabled:!z.trim()||Ht===0||J,className:"px-3 py-1.5 text-xs font-medium border border-gray-200 text-gray-700 hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:J?"Creating...":"Done"})]}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 mb-1",children:"Zone name"}),e.jsx("input",{type:"text",value:z,onChange:t=>ee(t.target.value),placeholder:"",className:"w-full px-3 py-1.5 text-sm border border-gray-200 focus:outline-none focus:ring-1 focus:ring-gray-400 mt-1"}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Customers won't see this"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 mb-2",children:"Shipping zones"}),e.jsxs("div",{className:"relative mb-3",children:[e.jsx("input",{type:"text",value:Le,onChange:t=>Ae(t.target.value),placeholder:"Search countries and regions to ship to",className:"w-full px-3 py-1.5 pl-10 text-sm border border-gray-200 focus:outline-none focus:ring-1 focus:ring-gray-400"}),e.jsx(ts,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"})]}),ws?e.jsx("div",{className:"border border-gray-200 py-12 text-center",children:e.jsx("div",{className:"inline-block w-6 h-6 border-2 border-gray-300 border-t-gray-900 rounded-full animate-spin"})}):Mt?e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 text-xs",children:Mt}):er(),e.jsx(es,{to:"/settings/markets",className:"inline-block mt-3 text-xs text-gray-600 hover:text-gray-900",children:"Add more countries/regions in Markets"})]})]})}),e.jsx(v,{open:ks,onClose:et,maxWidth:"sm",title:W?"Edit rate":"Add rate",actions:e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:et,className:"px-3 py-1.5 text-xs font-medium border border-gray-200 text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:Bs,disabled:!ce.trim()||$==="carrier"||ct,className:"px-3 py-1.5 text-xs font-medium border border-gray-200 text-gray-700 hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:ct?"Saving...":W?"Save":"Done"})]}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 mb-2",children:"Rate type"}),e.jsxs("select",{value:$,onChange:t=>le(t.target.value),className:"w-full px-3 py-1.5 text-sm border border-gray-200 focus:outline-none focus:ring-1 focus:ring-gray-400",children:[e.jsx("option",{value:"flat",children:"Use flat rate"}),e.jsx("option",{value:"carrier",children:"Use carrier or app to calculate rates"})]}),$==="carrier"&&e.jsxs("div",{className:"mt-2 bg-blue-50 border border-blue-200 text-blue-900 px-4 py-3 text-xs flex items-start justify-between gap-2",children:[e.jsx("span",{children:"There are no carriers or apps available for this zone. Change back to flat rate"}),e.jsx("button",{onClick:()=>le("flat"),className:"text-blue-600 underline font-medium shrink-0",children:"Change back to flat rate"})]})]}),$==="flat"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 mb-2",children:"Shipping rate"}),e.jsx("select",{value:zt,onChange:t=>Ge(t.target.value),className:"w-full px-3 py-1.5 text-sm border border-gray-200 focus:outline-none focus:ring-1 focus:ring-gray-400",children:e.jsx("option",{value:"custom",children:"Custom"})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 mb-2",children:"Custom rate name"}),e.jsx("input",{type:"text",value:ce,onChange:t=>Ke(t.target.value),placeholder:"",className:"w-full px-3 py-1.5 text-sm border border-gray-200 focus:outline-none focus:ring-1 focus:ring-gray-400"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 mb-2",children:"Custom delivery description (optional)"}),e.jsxs("select",{value:Vt,onChange:t=>Ye(t.target.value),className:"w-full px-3 py-1.5 text-sm border border-gray-200 focus:outline-none focus:ring-1 focus:ring-gray-400",children:[e.jsx("option",{value:"",children:"None"}),Is.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 mb-2",children:"Price"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-sm text-gray-600",children:"₹"}),e.jsx("input",{type:"text",value:de,onChange:t=>{const s=t.target.value.replace(/[^0-9.]/g,"");ue(s)},placeholder:"0.00",className:"w-full pl-8 pr-3 py-1.5 text-sm border border-gray-200 focus:outline-none focus:ring-1 focus:ring-gray-400"})]}),e.jsx("button",{onClick:()=>ue("0.00"),className:"px-3 py-1.5 text-xs font-medium border border-gray-200 text-gray-700 hover:bg-gray-50 transition-colors min-w-[80px]",children:"Free"})]})]}),k?e.jsxs("div",{className:"mt-3",children:[e.jsx("button",{onClick:()=>{xe(!1),U("weight"),me("0"),ge(""),pe("0.00"),he("")},className:"text-xs text-gray-600 hover:text-gray-900 underline mb-3 block",children:"Remove conditional pricing"}),e.jsxs("div",{className:"mb-3 flex gap-6",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",value:"weight",checked:j==="weight",onChange:t=>U(t.target.value),className:"w-4 h-4 text-gray-900 border-gray-300 focus:ring-gray-400"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Based on item weight"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",value:"price",checked:j==="price",onChange:t=>U(t.target.value),className:"w-4 h-4 text-gray-900 border-gray-300 focus:ring-gray-400"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Based on order price"})]})]}),j==="weight"?e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 mb-2",children:"Minimum weight"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:Bt,onChange:t=>{const s=t.target.value.replace(/[^0-9.]/g,"");me(s)},placeholder:"0",className:"w-full px-3 py-1.5 pr-12 text-sm border border-gray-200 focus:outline-none focus:ring-1 focus:ring-gray-400"}),e.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-sm text-gray-600",children:"kg"})]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 mb-2",children:"Maximum weight"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:Tt,onChange:t=>{const s=t.target.value.replace(/[^0-9.]/g,"");ge(s)},placeholder:"No limit",className:"w-full px-3 py-1.5 pr-12 text-sm border border-gray-200 focus:outline-none focus:ring-1 focus:ring-gray-400"}),e.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-sm text-gray-600",children:"kg"})]})]})]}):e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 mb-2",children:"Minimum price"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-sm text-gray-600",children:"₹"}),e.jsx("input",{type:"text",value:Ot,onChange:t=>{const s=t.target.value.replace(/[^0-9.]/g,"");pe(s)},placeholder:"0.00",className:"w-full pl-8 pr-3 py-1.5 text-sm border border-gray-200 focus:outline-none focus:ring-1 focus:ring-gray-400"})]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 mb-2",children:"Maximum price"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-sm text-gray-600",children:"₹"}),e.jsx("input",{type:"text",value:Wt,onChange:t=>{const s=t.target.value.replace(/[^0-9.]/g,"");he(s)},placeholder:"No limit",className:"w-full pl-8 pr-3 py-1.5 text-sm border border-gray-200 focus:outline-none focus:ring-1 focus:ring-gray-400"})]})]})]})]}):e.jsx("button",{onClick:()=>xe(!0),className:"text-xs text-gray-600 hover:text-gray-900 underline",children:"Add conditional pricing"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 mb-2",children:"Checkout preview"}),e.jsx("div",{className:"border border-gray-200 p-3 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",checked:!0,readOnly:!0,className:"w-4 h-4 text-gray-900 border-gray-300"}),e.jsx("p",{className:"text-sm text-gray-900",children:ce||"Rate name"})]}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:parseFloat(de)===0?"FREE":`₹ ${parseFloat(de).toFixed(2)}`})]})})]})]})]})}),e.jsx(v,{open:Ps,onClose:()=>{je||be(!1)},maxWidth:"sm",title:"Delete shipping profile",actions:e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>{je||be(!1)},className:"px-3 py-1.5 text-xs font-medium border border-gray-200 text-gray-700 hover:bg-gray-50 transition-colors",children:"No"}),e.jsx("button",{onClick:Ds,disabled:je,className:"px-3 py-1.5 text-xs font-medium border border-gray-200 text-red-600 hover:bg-red-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:je?"Deleting...":"Yes"})]}),children:e.jsxs("p",{className:"text-sm text-gray-600 leading-relaxed",children:["Are you sure you want to delete"," ",e.jsx("span",{className:"font-medium text-gray-900",children:x?.profileName||"this"})," ","shipping profile?"]})}),e.jsx(v,{open:!!ne,onClose:()=>{oe||ie(null)},maxWidth:"sm",title:"Delete shipping zone",actions:e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>{oe||ie(null)},className:"px-3 py-1.5 text-xs font-medium border border-gray-200 text-gray-700 hover:bg-gray-50 transition-colors",children:"No"}),e.jsx("button",{onClick:zs,disabled:oe,className:"px-3 py-1.5 text-xs font-medium border border-gray-200 text-red-600 hover:bg-red-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:oe?"Deleting...":"Yes"})]}),children:e.jsxs("p",{className:"text-sm text-gray-600 leading-relaxed",children:["Are you sure you want to delete"," ",e.jsx("span",{className:"font-medium text-gray-900",children:ne?.name||"this"})," ","shipping zone?"]})}),e.jsx(v,{open:!!G,onClose:()=>{ye||fe(null)},maxWidth:"sm",title:"Delete shipping rate",actions:e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>{ye||fe(null)},className:"px-3 py-1.5 text-xs font-medium border border-gray-200 text-gray-700 hover:bg-gray-50 transition-colors",children:"No"}),e.jsx("button",{onClick:Vs,disabled:ye,className:"px-3 py-1.5 text-xs font-medium border border-gray-200 text-red-600 hover:bg-red-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:ye?"Deleting...":"Yes"})]}),children:e.jsxs("p",{className:"text-sm text-gray-600 leading-relaxed",children:["Are you sure you want to delete"," ",e.jsx("span",{className:"font-medium text-gray-900",children:G?.rate.customRateName||"this"})," ","shipping zone rate from"," ",e.jsx("span",{className:"font-medium text-gray-900",children:G?.zoneName||"this"})," ","shipping zone?"]})})]}):e.jsx(Ne,{children:e.jsx("div",{className:"max-w-7xl mx-auto py-8 px-4",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-3",children:"Shipping profile not found"}),e.jsx("button",{onClick:Pe,className:"px-3 py-1.5 text-sm font-medium border border-gray-200 text-gray-700 hover:bg-gray-50 transition-colors",children:"Back to shipping settings"})]})})}):e.jsx(Ne,{children:e.jsx("div",{className:"max-w-7xl mx-auto py-8 px-4",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-3",children:"Invalid profile"}),e.jsx("button",{onClick:Pe,className:"px-3 py-1.5 text-sm font-medium border border-gray-200 text-gray-700 hover:bg-gray-50 transition-colors",children:"Back to shipping settings"})]})})})};export{Mr as default};
