import{j as e,u as V,b as W,I as H,r as t}from"./index-C7S6h9OR.js";import{T as j}from"./ToggleSwitch-DRYMOlwW.js";import{F as v}from"./InformationCircleIcon-B4YRJG0O.js";import{F as T}from"./ArrowRightIcon-5GXrrktH.js";import{G as Y}from"./GridBackgroundWrapper-Du1VLjut.js";import{M as J}from"./Modal-DsfhGJdg.js";import"./index-CCB_rw4P.js";const K=({accountUrl:n,onNavigateToAuthentication:a,onNavigateToDomains:o,selfServeReturns:s,onSelfServeReturnsChange:c,storeCredit:u,onStoreCreditChange:g,isControlsDisabled:i})=>e.jsxs("div",{className:"border border-gray-200 bg-white/95 p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("h2",{className:"text-sm font-medium text-gray-900",children:"Customer accounts"}),e.jsxs("div",{className:"group relative",children:[e.jsx(v,{className:"w-4 h-4 text-gray-500 cursor-help"}),e.jsx("div",{className:"absolute left-0 bottom-full mb-2 hidden group-hover:block z-10 w-64 p-2 bg-gray-900 text-white text-xs border border-gray-200",children:"Manage sign-in methods and account access"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Authentication"}),e.jsx("p",{className:"text-xs text-gray-600 mt-0.5",children:"Manage sign-in methods and account access"})]}),e.jsxs("button",{onClick:a,className:"px-3 py-1.5 text-sm font-medium border border-gray-200 text-gray-700 hover:bg-gray-50 transition-colors flex items-center gap-2 self-start sm:self-center",children:["Manage",e.jsx(T,{className:"w-4 h-4"})]})]}),e.jsx("div",{className:"border-t border-gray-200"}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Self-serve returns"}),e.jsxs("p",{className:"text-xs text-gray-600 mt-0.5",children:["Allow customers to request and manage returns. Customize what your customers can return with"," ",e.jsx("button",{className:"text-gray-700 hover:underline",children:"return rules"})]})]}),e.jsx(j,{checked:s,onChange:c,disabled:i})]}),e.jsx("div",{className:"border-t border-gray-200"}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Store credit"}),e.jsx("p",{className:"text-xs text-gray-600 mt-0.5",children:"Allow customers to see and spend store credit"})]}),e.jsx(j,{checked:u,onChange:g,disabled:i})]}),e.jsx("div",{className:"border-t border-gray-200"}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"URL"}),e.jsx("p",{className:"text-xs text-gray-600 mt-0.5 mb-2",children:"Use this URL anywhere you'd like customers to access customer accounts"}),e.jsx("input",{type:"text",value:n||"",readOnly:!0,className:"w-full px-3 py-2 border border-gray-200 bg-gray-50 text-sm text-gray-900 focus:outline-none focus:ring-1 focus:ring-gray-400 focus:border-gray-400"})]}),e.jsxs("button",{onClick:o,className:"px-3 py-1.5 text-sm font-medium border border-gray-200 text-gray-700 hover:bg-gray-50 transition-colors flex items-center gap-2 self-start sm:self-center",children:["Manage",e.jsx(T,{className:"w-4 h-4"})]})]})]})]}),Q=({showSignInLinks:n,onShowSignInLinksChange:a,accountVersion:o,onAccountVersionChange:s,isControlsDisabled:c})=>e.jsxs("div",{className:"border border-gray-200 bg-white/95 p-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h2",{className:"text-sm font-medium text-gray-900",children:"Sign-in links"}),e.jsxs("div",{className:"group relative",children:[e.jsx(v,{className:"w-4 h-4 text-gray-500 cursor-help"}),e.jsx("div",{className:"absolute left-0 bottom-full mb-2 hidden group-hover:block z-10 w-64 p-2 bg-gray-900 text-white text-xs border border-gray-200",children:"Show sign-in links in the header of online store and at checkout"})]})]}),e.jsx("p",{className:"text-xs text-gray-600",children:"Show sign-in links in the header of online store and at checkout"})]}),e.jsx(j,{checked:n,onChange:a,disabled:c})]}),n?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-gray-50 border border-gray-200 p-3 mb-4 flex items-start gap-2",children:[e.jsx(v,{className:"w-4 h-4 shrink-0 mt-0.5 text-gray-600"}),e.jsxs("p",{className:"text-xs text-gray-600",children:["Customers are required to sign in before checking out. To change this, go to"," ",e.jsx("button",{className:"text-gray-700 font-medium cursor-pointer hover:underline",children:"checkout settings"}),"."]})]}),e.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-3",children:"Choose which version of customer accounts to link to"}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-3",children:[e.jsxs("div",{onClick:()=>!c&&s("recommended"),className:`flex-1 p-3 border transition-all cursor-pointer flex items-start gap-3 ${o==="recommended"?"border-gray-900":"border-gray-200"} ${c?"opacity-50 cursor-not-allowed":"hover:border-gray-300"}`,children:[e.jsx("div",{className:"mt-0.5",children:e.jsx("input",{type:"radio",value:"recommended",checked:o==="recommended",onChange:()=>s("recommended"),disabled:c,className:"w-4 h-4 text-gray-600 border-gray-300 focus:ring-gray-400 focus:ring-1"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Customer accounts"}),e.jsx("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-700 text-xs font-medium border border-gray-200",children:"Recommended"})]}),e.jsx("p",{className:"text-xs text-gray-600",children:"Customers sign in with a one-time code sent to their email (no passwords)"})]})]}),e.jsxs("div",{onClick:()=>!c&&s("legacy"),className:`flex-1 p-3 border transition-all cursor-pointer flex items-start gap-3 ${o==="legacy"?"border-gray-900":"border-gray-200"} ${c?"opacity-50 cursor-not-allowed":"hover:border-gray-300"}`,children:[e.jsx("div",{className:"mt-0.5",children:e.jsx("input",{type:"radio",value:"legacy",checked:o==="legacy",onChange:()=>s("legacy"),disabled:c,className:"w-4 h-4 text-gray-600 border-gray-300 focus:ring-gray-400 focus:ring-1"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-1",children:"Legacy"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Customers create an account and sign in with email and password"})]})]})]})]}):e.jsx("p",{className:"text-xs text-gray-600 mt-2",children:"Both versions are still accessible by URL"})]}),X=({open:n,onClose:a,onConfirm:o})=>e.jsx(J,{open:n,onClose:a,title:"Turn off self-serve returns?",maxWidth:"sm",actions:e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:a,className:"px-4 py-2 border border-gray-300 text-gray-900 rounded-md hover:bg-gray-50 hover:border-gray-400 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:o,className:"px-4 py-2 bg-gray-900 text-white rounded-md hover:bg-gray-800 transition-colors",children:"Turn off self-serve returns"})]}),children:e.jsx("p",{className:"text-sm text-gray-600",children:"Customers will no longer be able to request returns from their accounts. You can still process any return requests that need your review."})}),ne=()=>{const n=V(),{activeStoreId:a,stores:o}=W(),{settings:s,loading:c,error:u,fetchByStoreId:g,update:i}=H(),[d,N]=t.useState(!1),[m,w]=t.useState("recommended"),[l,h]=t.useState(!1),[x,C]=t.useState(!1),[L,f]=t.useState(!1),[S,A]=t.useState(!1),[U,k]=t.useState(""),[I,y]=t.useState(!1),[R,M]=t.useState(!1),b=t.useMemo(()=>o.find(r=>r._id===a)||null,[o,a]);t.useEffect(()=>{a&&g(a).catch(()=>{})},[a,g]),t.useEffect(()=>{if(!s){k("");return}N(!!s.showSignInLinks),w(s.accountVersion),h(!!s.selfServeReturns),C(!!s.storeCredit);const P=`https://ziplofy.com/${b?.storeName?b.storeName.toLowerCase().replace(/[^a-z0-9]+/g,"-"):"store"}/account`;k(s.customAccountUrl||P)},[s,b]),t.useEffect(()=>{if(!s){y(!1);return}const r=d!==s.showSignInLinks||m!==s.accountVersion||l!==s.selfServeReturns||x!==s.storeCredit;y(r)},[s,d,m,l,x]);const p=c||!s||R,O=t.useCallback(async()=>{if(s?._id)try{M(!0),await i(s._id,{showSignInLinks:d,accountVersion:m,selfServeReturns:l,storeCredit:x}),y(!1)}catch{}finally{M(!1)}},[s,d,m,l,x,i]),B=t.useCallback(r=>{N(r)},[]),F=t.useCallback(r=>{w(r)},[]),$=t.useCallback(r=>{l&&!r?(A(r),f(!0)):h(r)},[l]),z=t.useCallback(r=>{C(r)},[]),E=t.useCallback(()=>{f(!1)},[]),q=t.useCallback(()=>{h(S),f(!1)},[S]),_=t.useCallback(()=>{n("/settings/customer-accounts/authentication")},[n]),G=t.useCallback(()=>{n("/settings/domains")},[n]);return e.jsx(Y,{children:e.jsxs("div",{className:"max-w-7xl mx-auto py-8 px-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-4 border-b border-gray-200 pb-4",children:[e.jsx("h1",{className:"text-xl font-medium text-gray-900",children:"Customer accounts"}),s&&e.jsx("button",{onClick:O,disabled:!I||p,className:"px-3 py-1.5 text-sm font-medium border border-gray-200 text-gray-700 min-w-[100px] disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50 transition-colors",children:R?"Saving...":"Save"})]}),u&&e.jsx("div",{className:"bg-gray-50 border border-gray-200 text-gray-700 px-4 py-3 mb-4 text-xs",children:u}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(Q,{showSignInLinks:d,onShowSignInLinksChange:B,accountVersion:m,onAccountVersionChange:F,isControlsDisabled:p}),e.jsx(K,{accountUrl:U,onNavigateToAuthentication:_,onNavigateToDomains:G,selfServeReturns:l,onSelfServeReturnsChange:$,storeCredit:x,onStoreCreditChange:z,isControlsDisabled:p})]}),e.jsx(X,{open:L,onClose:E,onConfirm:q})]})})};export{ne as default};
