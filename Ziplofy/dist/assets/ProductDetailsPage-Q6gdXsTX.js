import{j as e,i as E,u as $,p as ge,d as he,b as pe,aC as ue,r as a}from"./index-C7S6h9OR.js";import{M as k}from"./Modal-DsfhGJdg.js";import{F as R}from"./TrashIcon-B2-WJkmb.js";import{F as be}from"./ArrowLeftIcon-C1qOxHB_.js";import{P as ye}from"./ProductNotFound-yIBul6fi.js";import"./index-CCB_rw4P.js";const je=({isOpen:s,product:r,selectedOptionName:t,newOptionValues:n,submittingOption:o,onClose:h,onSubmit:u,onOptionNameChange:p,onUpdateNewOptionValue:f,onAddNewOptionValue:v,onRemoveNewOptionValue:d})=>e.jsx(k,{open:s,onClose:h,title:"Add Option Values",maxWidth:"md",actions:e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:h,disabled:o,className:"px-3 py-1.5 text-sm font-medium text-gray-700 border border-gray-200 hover:bg-gray-50 transition-colors disabled:opacity-50",children:"Cancel"}),e.jsx("button",{onClick:u,disabled:!t||n.every(c=>!c.trim())||o,className:"px-3 py-1.5 text-sm font-medium text-white bg-gray-900 hover:bg-gray-800 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:o?"Adding...":"Add Values"})]}),children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Add new values to an existing variant option. This will create new variants with the additional values."}),e.jsxs("select",{value:t,onChange:c=>p(c.target.value),className:"w-full px-3 py-1.5 text-sm border border-gray-200 focus:outline-none focus:ring-1 focus:ring-gray-400 focus:border-gray-400",children:[e.jsx("option",{value:"",disabled:!0,children:"Select an option to add values to"}),r?.variants?.map((c,x)=>e.jsx("option",{value:c.optionName,children:c.optionName},x))]}),t&&e.jsxs("div",{className:"p-3 bg-gray-50 border border-gray-200",children:[e.jsxs("p",{className:"text-sm font-medium mb-2",children:['Current values for "',t,'":']}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:r?.variants?.find(c=>c.optionName===t)?.values?.map((c,x)=>e.jsx("span",{className:"px-2 py-1 text-xs font-medium border border-gray-200 text-gray-700",children:c},x))})]}),e.jsx("p",{className:"text-sm font-medium",children:"New Option Values"}),n.map((c,x)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",className:"flex-1 px-3 py-1.5 text-sm border border-gray-200 focus:outline-none focus:ring-1 focus:ring-gray-400 focus:border-gray-400",placeholder:"Enter new value",value:c,onChange:y=>f(x,y.target.value)}),e.jsx("button",{onClick:()=>d(x),disabled:n.length===1,className:"p-2 text-gray-600 hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(R,{className:"w-4 h-4"})})]},x)),e.jsxs("button",{onClick:v,className:"text-sm text-gray-700 hover:text-gray-900 font-medium mt-1 flex items-center gap-1 w-fit",children:[e.jsx(E,{className:"w-4 h-4"}),"Add another value"]})]})}),Ne=({isOpen:s,variantsForm:r,submittingVariants:t,onClose:n,onSubmit:o,onAddVariantRow:h,onRemoveVariantRow:u,onUpdateVariantOptionName:p,onAddVariantValue:f,onRemoveVariantValue:v,onUpdateVariantValue:d})=>e.jsx(k,{open:s,onClose:n,title:"Add Product Variants",maxWidth:"md",actions:e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:n,disabled:t,className:"px-3 py-1.5 text-sm font-medium text-gray-700 border border-gray-200 hover:bg-gray-50 transition-colors disabled:opacity-50",children:"Cancel"}),e.jsx("button",{onClick:o,disabled:t,className:"px-3 py-1.5 text-sm font-medium text-white bg-gray-900 hover:bg-gray-800 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:t?"Saving...":"Save"})]}),children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Add options like size or color. Each option can have multiple values."}),e.jsxs("div",{className:"flex flex-col gap-4",children:[r.map((c,x)=>e.jsxs("div",{className:"p-3 border border-gray-200 bg-gray-50",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsxs("p",{className:"text-sm font-medium",children:["Option ",x+1]}),e.jsx("button",{onClick:()=>u(x),className:"p-1 text-gray-600 hover:bg-gray-100 transition-colors",children:e.jsx(R,{className:"w-4 h-4"})})]}),e.jsx("input",{type:"text",className:"w-full px-3 py-1.5 text-sm border border-gray-200 mb-3 focus:outline-none focus:ring-1 focus:ring-gray-400 focus:border-gray-400",placeholder:"e.g., Size, Color, Material",value:c.optionName,onChange:y=>p(x,y.target.value)}),e.jsx("p",{className:"text-sm font-medium mb-2",children:"Option Values"}),c.values.map((y,b)=>e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("input",{type:"text",className:"flex-1 px-3 py-1.5 text-sm border border-gray-200 focus:outline-none focus:ring-1 focus:ring-gray-400 focus:border-gray-400",placeholder:"Enter value",value:y,onChange:V=>d(x,b,V.target.value)}),e.jsx("button",{onClick:()=>v(x,b),disabled:c.values.length===1,className:"p-2 text-gray-600 hover:bg-gray-100 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(R,{className:"w-4 h-4"})})]},b)),e.jsxs("button",{onClick:()=>f(x),className:"text-sm text-gray-700 hover:text-gray-900 font-medium mt-1 flex items-center gap-1 w-fit",children:[e.jsx(E,{className:"w-4 h-4"}),"Add another value"]})]},x)),e.jsxs("button",{onClick:h,className:"w-full border border-gray-200 text-gray-700 px-4 py-2 text-sm font-medium hover:bg-gray-50 transition-colors flex items-center justify-center gap-2",children:[e.jsx(E,{className:"w-4 h-4"}),"Add options like size or color"]})]})]})}),fe=({isOpen:s,selectedDimension:r,deletingVariant:t,onClose:n,onConfirm:o})=>e.jsx(k,{open:s,onClose:n,title:e.jsx("span",{className:"text-red-600",children:"⚠️ Confirm Deletion"}),maxWidth:"sm",actions:e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:n,disabled:t,className:"px-3 py-1.5 text-sm font-medium text-gray-700 border border-gray-200 hover:bg-gray-50 transition-colors disabled:opacity-50",children:"Cancel"}),e.jsx("button",{onClick:o,disabled:t,className:"px-3 py-1.5 text-sm font-medium text-white bg-red-600 hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:t?"Deleting...":"Delete Permanently"})]}),children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("p",{className:"text-sm text-gray-900",children:["Are you sure you want to delete the ",e.jsxs("strong",{children:['"',r,'"']})," dimension?"]}),e.jsx("p",{className:"text-sm text-red-600",children:"⚠️ This action cannot be undone. All product variants containing this dimension will be permanently removed."}),e.jsx("p",{className:"text-sm text-gray-600",children:"If this is the only dimension, the product will revert to a single default variant."})]})}),ve=({isOpen:s,product:r,selectedDimension:t,onClose:n,onContinue:o,onDimensionChange:h})=>e.jsx(k,{open:s,onClose:n,title:"Delete Variant Dimension",maxWidth:"sm",actions:e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:n,className:"px-3 py-1.5 text-sm font-medium text-gray-700 border border-gray-200 hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:o,disabled:!t,className:"px-3 py-1.5 text-sm font-medium text-white bg-red-600 hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Continue"})]}),children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Select the variant dimension you want to delete from this product. This action will remove all variants that contain this dimension."}),e.jsxs("select",{value:t,onChange:u=>h(u.target.value),className:"w-full px-3 py-1.5 text-sm border border-gray-200 focus:outline-none focus:ring-1 focus:ring-gray-400 focus:border-gray-400",children:[e.jsx("option",{value:"",disabled:!0,children:"Select a dimension to delete"}),r?.variants?.map((u,p)=>e.jsx("option",{value:u.optionName,children:u.optionName},p))]})]})}),we=({product:s})=>e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200/80 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-100 pl-4 border-l-4 border-l-blue-500/60",children:e.jsx("h2",{className:"text-sm font-semibold text-gray-900",children:"Basic Information"})}),e.jsxs("div",{className:"p-4 grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1.5",children:"Category"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.category&&typeof s.category=="object"&&s.category.name||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1.5",children:"SKU"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.sku||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1.5",children:"Barcode"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.barcode||"N/A"})]})]})]}),Ce=({product:s,variantsCount:r,onAddVariants:t,onDeleteVariant:n,onAddOption:o})=>{const h=$();return e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>h("/products"),className:"flex items-center gap-2 text-gray-600 hover:text-blue-600 mb-4 transition-colors",children:[e.jsx(be,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium",children:"Back to Products"})]}),e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4 mb-4",children:[e.jsxs("div",{className:"pl-3 border-l-4 border-blue-500/60",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 tracking-tight",children:s.title||"Untitled"}),s.description&&e.jsx("p",{className:"text-sm text-gray-500 mt-0.5 line-clamp-2",children:s.description})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:t,className:"px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors",children:"Add Variants"}),e.jsx("button",{onClick:n,disabled:!s?.variants||s.variants.length===0,className:"px-4 py-2 border border-gray-200 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Delete Variant"}),e.jsx("button",{onClick:o,disabled:!s?.variants||s.variants.length===0||r<=1,className:"px-4 py-2 border border-gray-200 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Add Option"})]})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx("span",{className:`px-2.5 py-1 rounded-lg text-xs font-medium ${s.status==="active"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:s.status||"draft"}),s.onlineStorePublishing&&e.jsx("span",{className:"px-2.5 py-1 rounded-lg text-xs font-medium border border-gray-200 text-gray-700",children:"Online"}),s.pointOfSalePublishing&&e.jsx("span",{className:"px-2.5 py-1 rounded-lg text-xs font-medium border border-gray-200 text-gray-700",children:"POS"})]})]})},ke=({imageUrls:s})=>{const r=Array.isArray(s)?s:[];return r.length===0?null:e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200/80 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-100 pl-4 border-l-4 border-l-blue-500/60",children:e.jsx("h2",{className:"text-sm font-semibold text-gray-900",children:"Images"})}),e.jsx("div",{className:"p-4 grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:r.map((t,n)=>e.jsx("div",{className:"relative rounded-lg overflow-hidden border border-gray-200 aspect-square bg-gray-50",children:e.jsx("img",{src:t,alt:`Product image ${n+1}`,className:"w-full h-full object-cover block",onError:o=>{o.currentTarget.style.display="none"}})},`${t}-${n}`))})]})},Ve=({product:s})=>!s.variants||s.variants.length===0?null:e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200/80 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-100 pl-4 border-l-4 border-l-blue-500/60",children:e.jsx("h2",{className:"text-sm font-semibold text-gray-900",children:"Product Options"})}),e.jsx("div",{className:"p-4 grid grid-cols-1 sm:grid-cols-2 gap-3",children:s.variants.map(r=>e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 mb-2",children:r.optionName}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:r.values.map(t=>e.jsx("span",{className:"px-2.5 py-1 rounded-lg text-xs font-medium border border-gray-200 text-gray-700",children:t},t))})]},r._id))})]}),Oe=({product:s})=>e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200/80 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-100 pl-4 border-l-4 border-l-blue-500/60",children:e.jsx("h2",{className:"text-sm font-semibold text-gray-900",children:"Organization"})}),e.jsxs("div",{className:"p-4 grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1.5",children:"Product Type"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.productType&&typeof s.productType=="object"&&s.productType.name||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1.5",children:"Vendor"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.vendor&&typeof s.vendor=="object"&&s.vendor.name||"N/A"})]})]}),Array.isArray(s.tagIds)&&s.tagIds.length>0&&e.jsxs("div",{className:"mt-4 col-span-full",children:[e.jsx("p",{className:"text-xs text-gray-600 mb-2",children:"Tags"}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:s.tagIds.map(r=>e.jsx("span",{className:"px-2.5 py-1 rounded-lg text-xs font-medium border border-gray-200 text-gray-700",children:r?.name||"N/A"},r._id))})]})]}),Ae=({product:s})=>e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200/80 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-100 pl-4 border-l-4 border-l-blue-500/60",children:e.jsx("h2",{className:"text-sm font-semibold text-gray-900",children:"Pricing"})}),e.jsxs("div",{className:"p-4 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1.5",children:"Price"}),e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:["₹",s.price!=null?Number(s.price).toFixed(2):"0.00"]})]}),typeof s.compareAtPrice=="number"&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1.5",children:"Compare At"}),e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:["₹",s.compareAtPrice.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1.5",children:"Cost"}),e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:["₹",s.cost!=null?Number(s.cost).toFixed(2):"0.00"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1.5",children:"Profit"}),e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:["₹",s.profit!=null?Number(s.profit).toFixed(2):"0.00"," (",s.marginPercent!=null?Number(s.marginPercent).toFixed(1):"0.0","%)"]})]})]})]}),Se=({product:s})=>s.isPhysicalProduct?e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200/80 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-100 pl-4 border-l-4 border-l-blue-500/60",children:e.jsx("h2",{className:"text-sm font-semibold text-gray-900",children:"Shipping Information"})}),e.jsxs("div",{className:"p-4 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1.5",children:"Package"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.package?.packageName||"N/A"}),s.package&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[s.package.length," × ",s.package.width," × ",s.package.height," ",s.package.dimensionsUnit]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1.5",children:"Weight"}),e.jsxs("p",{className:"text-sm text-gray-900",children:[s.productWeight??"—"," ",s.productWeightUnit??""]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1.5",children:"Origin"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.countryOfOrigin||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1.5",children:"HS Code"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.harmonizedSystemCode||"N/A"})]})]})]}):null,Pe=({product:s})=>e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200/80 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-100 pl-4 border-l-4 border-l-blue-500/60",children:e.jsx("h2",{className:"text-sm font-semibold text-gray-900",children:"Status & Details"})}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1.5",children:"Status"}),e.jsx("span",{className:`inline-block px-2.5 py-1 rounded text-xs font-medium ${s.status==="active"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:s.status})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1.5",children:"Inventory Tracking"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.inventoryTrackingEnabled?"Enabled":"Disabled"}),s.inventoryTrackingEnabled&&e.jsxs("p",{className:"text-sm text-gray-900 mt-1",children:["Quantity: ",s.quantity??0]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1.5",children:"Continue Selling When Out of Stock"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.continueSellingWhenOutOfStock?"Yes":"No"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1.5",children:"Created"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.createdAt?new Date(s.createdAt).toLocaleDateString():"—"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1.5",children:"Updated"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.updatedAt?new Date(s.updatedAt).toLocaleDateString():"—"})]})]})]}),De=({variant:s,productId:r})=>{const t=$(),n=()=>{t(`/products/${r}/variants/${s._id}`)};return e.jsxs("div",{className:"p-4 border border-gray-200 rounded-xl cursor-pointer transition-all hover:shadow-md hover:border-blue-500/60 hover:bg-blue-50/30",onClick:n,children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.sku||"N/A"}),e.jsxs("p",{className:"text-sm font-medium text-gray-600",children:["₹",s.price?.toFixed(2)||"0.00"]})]}),e.jsx("div",{className:"flex gap-2 flex-wrap mb-4",children:s.optionValues&&Object.entries(s.optionValues).map(([o,h])=>e.jsxs("span",{className:"px-2 py-1 text-xs font-medium rounded-lg border border-gray-200 text-gray-700",children:[o,": ",h]},`${o}-${h}`))}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Inventory Tracking"}),e.jsx("p",{className:"text-base",children:s.isInventoryTrackingEnabled?"Enabled":"Disabled"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Weight"}),e.jsxs("p",{className:"text-base",children:[s.weightValue||0," ",s.weightUnit||"kg"]})]})]}),e.jsx("div",{className:"mt-4",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Continue selling: ",s.outOfStockContinueSelling?"Yes":"No"]})})]})};function Fe({variants:s,productId:r,loading:t}){return e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200/80 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"px-4 py-3 border-b border-gray-100 pl-4 border-l-4 border-l-blue-500/60",children:e.jsxs("h2",{className:"text-sm font-semibold text-gray-900",children:["Product Variants (",s.length,")"]})}),e.jsxs("div",{className:"p-4",children:[t&&e.jsx("p",{className:"text-sm text-gray-600",children:"Loading variants..."}),!t&&s.length===0&&e.jsx("p",{className:"text-sm text-gray-600",children:"No variants available."}),!t&&s.length>0&&e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:s.map(n=>e.jsx(De,{variant:n,productId:r},n._id))})]})]})}const We=()=>{const{id:s}=ge();$();const{products:r,addVariantsToProduct:t,deleteVariantFromProduct:n,addOptionToProduct:o,fetchProductsByStoreId:h}=he(),{activeStoreId:u}=pe(),{fetchVariantsByProductId:p,variants:f,loading:v}=ue(),d=a.useMemo(()=>r.find(l=>l._id===s),[r,s]);a.useEffect(()=>{u&&s&&r.length===0&&h(u)},[u,s,r.length,h]);const[c,x]=a.useState(!1),[y,b]=a.useState([{optionName:"",values:[""]}]),[V,O]=a.useState(!1),[L,I]=a.useState(!1),[N,A]=a.useState(""),[q,U]=a.useState(!1),[H,W]=a.useState(!1),[w,_]=a.useState(""),[S,C]=a.useState([""]),[Y,M]=a.useState(!1),G=a.useCallback(()=>{x(!0)},[]),P=a.useCallback(()=>{x(!1),b([{optionName:"",values:[""]}])},[]),K=a.useCallback(()=>{O(!0)},[]),Q=a.useCallback(()=>{O(!1),A("")},[]),J=a.useCallback(()=>{N&&(O(!1),I(!0))},[N]),D=a.useCallback(()=>{I(!1),A("")},[]),X=a.useCallback(()=>{W(!0)},[]),F=a.useCallback(()=>{W(!1),_(""),C([""])},[]),Z=a.useCallback(async()=>{if(!(!d||!N))try{U(!0),await n(d._id,N),await p(d._id),D()}catch(l){console.error("Failed to delete variant dimension:",l)}finally{U(!1)}},[d,N,n,p,D]),ee=a.useCallback(()=>{b(l=>[...l,{optionName:"",values:[""]}])},[]),se=a.useCallback(l=>{b(i=>i.filter((m,g)=>g!==l))},[]),ae=a.useCallback((l,i)=>{b(m=>m.map((g,j)=>j===l?{...g,optionName:i}:g))},[]),te=a.useCallback(l=>{b(i=>i.map((m,g)=>g===l?{...m,values:[...m.values,""]}:m))},[]),re=a.useCallback((l,i)=>{b(m=>m.map((g,j)=>j===l?{...g,values:g.values.filter((z,T)=>T!==i)}:g))},[]),le=a.useCallback((l,i,m)=>{b(g=>g.map((j,z)=>z===l?{...j,values:j.values.map((T,me)=>me===i?m:T)}:j))},[]),[ne,B]=a.useState(!1),ie=a.useCallback(async()=>{if(!s)return;const l=y.map(i=>({optionName:i.optionName.trim(),values:i.values.map(m=>m.trim()).filter(Boolean)})).filter(i=>i.optionName&&i.values.length>0);if(l.length!==0)try{B(!0),await t(s,l),P(),p(s)}catch{}finally{B(!1)}},[s,y,t,p,P]),oe=a.useCallback(async()=>{if(!s||!w)return;const l=S.filter(i=>i.trim().length>0);if(l.length!==0)try{M(!0),console.log("Calling addOptionToProduct with:",{productId:s,optionName:w,values:l}),await o(s,w,l),console.log("Successfully added option values"),F(),p(s)}catch(i){console.error("Error adding option values:",i)}finally{M(!1)}},[s,w,S,o,p,F]),de=a.useCallback((l,i)=>{C(m=>{const g=[...m];return g[l]=i,g})},[]),ce=a.useCallback(()=>{C(l=>[...l,""])},[]),xe=a.useCallback(l=>{C(i=>{const m=i.filter((g,j)=>j!==l);return m.length>0?m:[""]})},[]);return a.useEffect(()=>{s&&p(s)},[s,p]),d?e.jsxs("div",{className:"min-h-screen bg-page-background-color",children:[e.jsxs("div",{className:"max-w-[1400px] mx-auto px-3 sm:px-4 py-4",children:[e.jsx(Ce,{product:d,variantsCount:f.length,onAddVariants:G,onDeleteVariant:K,onAddOption:X}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsx(ke,{imageUrls:d.imageUrls||[]}),e.jsx(we,{product:d}),e.jsx(Ae,{product:d}),e.jsx(Oe,{product:d}),e.jsx(Se,{product:d}),e.jsx(Ve,{product:d}),e.jsx(Fe,{variants:f,productId:s||"",loading:v})]}),e.jsx("div",{className:"lg:col-span-1",children:e.jsx(Pe,{product:d})})]})]}),e.jsx(Ne,{isOpen:c,variantsForm:y,submittingVariants:ne,onClose:P,onSubmit:ie,onAddVariantRow:ee,onRemoveVariantRow:se,onUpdateVariantOptionName:ae,onAddVariantValue:te,onRemoveVariantValue:re,onUpdateVariantValue:le}),e.jsx(ve,{isOpen:V,product:d,selectedDimension:N,onClose:Q,onContinue:J,onDimensionChange:A}),e.jsx(fe,{isOpen:L,selectedDimension:N,deletingVariant:q,onClose:D,onConfirm:Z}),e.jsx(je,{isOpen:H,product:d,selectedOptionName:w,newOptionValues:S,submittingOption:Y,onClose:F,onSubmit:oe,onOptionNameChange:_,onUpdateNewOptionValue:de,onAddNewOptionValue:ce,onRemoveNewOptionValue:xe})]}):e.jsx(ye,{})};export{We as default};
