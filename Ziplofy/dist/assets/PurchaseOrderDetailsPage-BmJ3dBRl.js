import{p as w,u as C,q as k,r as a,s as S,j as e,F as O}from"./index-C7S6h9OR.js";import{G as P}from"./GridBackgroundWrapper-Du1VLjut.js";import{F as T}from"./ArrowLeftIcon-C1qOxHB_.js";function F(){const{id:n}=w(),d=C(),{purchaseOrders:m,markAsOrdered:g}=k(),s=a.useMemo(()=>m.find(t=>t._id===n)||null,[m,n]),{entries:o,fetchEntriesByPurchaseOrderId:y,loading:u,error:h,clearEntries:j}=S(),[i,c]=a.useState(!1),[N,x]=a.useState(!1),l=a.useRef(null);a.useEffect(()=>{const t=r=>{l.current&&!l.current.contains(r.target)&&c(!1)};return i&&document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[i]),a.useEffect(()=>{if(s?._id)return y(s._id).catch(()=>{}),()=>{j()}},[s?._id]);const b=a.useMemo(()=>s?typeof s.supplierId=="string"?s.supplierId:s.supplierId?.name||s.supplierId?._id:"-",[s]),f=a.useMemo(()=>s?typeof s.destinationLocationId=="string"?s.destinationLocationId:s.destinationLocationId?.name||s.destinationLocationId?._id:"-",[s]);return e.jsx(P,{children:e.jsxs("div",{className:"min-h-screen",children:[e.jsx("div",{className:"border-b border-gray-200 px-4 py-3",children:e.jsx("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("button",{onClick:()=>d("/products/purchase-orders"),className:"text-sm text-gray-600 hover:text-gray-900 transition-colors",children:[e.jsx(T,{className:"w-4 h-4 inline mr-1"}),"Purchase Orders"]})})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[!s&&e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Purchase order not found in current view. Go back to the list and select one."}),e.jsx("button",{onClick:()=>d("/products/purchase-orders"),className:"w-fit px-3 py-1.5 text-sm font-medium border border-gray-200 hover:bg-gray-50 transition-colors",children:"Back to Purchase Orders"})]}),s&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h1",{className:"text-xl font-medium text-gray-900",children:"Purchase Order Details"}),e.jsx("span",{className:`px-2 py-0.5 text-xs font-medium ${s.status==="ordered"?"bg-gray-900 text-white":"bg-gray-100 text-gray-700"}`,children:(s.status||"draft").replaceAll("_"," ")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[s.status==="draft"&&e.jsx("button",{onClick:()=>x(!0),className:"px-3 py-1.5 text-sm font-medium bg-gray-900 text-white hover:bg-gray-800 transition-colors",children:"Mark as ordered"}),s.status!=="draft"&&e.jsx("button",{onClick:()=>d(`/products/purchase-orders/${s._id}/receive`),className:"px-3 py-1.5 text-sm font-medium bg-gray-900 text-white hover:bg-gray-800 transition-colors",children:"Receive Inventory"}),s.status==="draft"&&e.jsxs("div",{className:"relative",ref:l,children:[e.jsxs("button",{onClick:()=>c(!i),className:"px-3 py-1.5 text-sm font-medium border border-gray-200 hover:bg-gray-50 transition-colors flex items-center gap-1",children:["More actions",e.jsx(O,{className:"w-4 h-4"})]}),i&&e.jsx("div",{className:"absolute right-0 mt-1 w-48 bg-white border border-gray-200 shadow-lg z-10",children:e.jsx("button",{onClick:()=>c(!1),className:"w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-gray-50 transition-colors",children:"Delete"})})]})]})]}),N&&e.jsxs("div",{className:"border border-gray-200 p-4 bg-white/95",children:[e.jsx("h2",{className:"text-base font-medium text-gray-900 mb-2",children:"Mark as ordered"}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"After marking as ordered, you will be able to receive incoming inventory from your supplier. The purchase order can't be turned into a draft again."}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>x(!1),className:"px-3 py-1.5 text-sm font-medium text-gray-700 border border-gray-200 hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:async()=>{s&&(await g(s._id),x(!1))},className:"px-3 py-1.5 text-sm font-medium bg-gray-900 text-white hover:bg-gray-800 transition-colors",children:"Mark as ordered"})]})]}),e.jsxs("div",{className:"border border-gray-200 p-4 bg-white/95",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Supplier"}),e.jsx("p",{className:"text-sm text-gray-900",children:b})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Destination"}),e.jsx("p",{className:"text-sm text-gray-900",children:f})]})]}),e.jsx("div",{className:"border-t border-gray-200 my-3"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Payment Terms"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.paymentTerm||"-"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Supplier Currency"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.supplierCurrency||"-"})]})]})]}),e.jsxs("div",{className:"border border-gray-200 p-4 bg-white/95",children:[e.jsx("h2",{className:"text-base font-medium text-gray-900 mb-3",children:"Shipment Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Estimated Arrival"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.expectedArrivalDate?new Date(s.expectedArrivalDate).toLocaleDateString():"-"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Shipping Carrier"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.shippingCarrier||"-"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Tracking Number"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.trackingNumber||"-"})]})]})]}),e.jsxs("div",{className:"border border-gray-200 p-4 bg-white/95",children:[e.jsx("h2",{className:"text-base font-medium text-gray-900 mb-3",children:"Products"}),h&&e.jsx("p",{className:"text-sm text-red-600 mb-2",children:h}),e.jsx("div",{className:"border border-gray-200 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-900",children:"Product"}),e.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-900",children:"Supplier SKU"}),e.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-900",children:"RSKU"}),e.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-900",children:"Quantity"}),e.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-900",children:"Cost"}),e.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-900",children:"Tax %"}),e.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-900",children:"Total"})]})}),e.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[o.map(t=>{const r=t.variantId,v=r?.productId?.title||"-",p=r?.optionValues?Object.values(r.optionValues).join(" / "):"";return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-2",children:e.jsxs("div",{className:"space-y-0.5",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:v}),p&&e.jsx("p",{className:"text-xs text-gray-600",children:p}),e.jsxs("p",{className:"text-xs text-gray-600",children:["SKU: ",r?.sku||"-"]})]})}),e.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:t.supplierSku||"-"}),e.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:r?.sku||"-"}),e.jsx("td",{className:"px-4 py-2 text-sm text-gray-900 text-right",children:t.quantityOrdered}),e.jsx("td",{className:"px-4 py-2 text-sm text-gray-900 text-right",children:t.cost.toFixed(2)}),e.jsx("td",{className:"px-4 py-2 text-sm text-gray-900 text-right",children:(t.taxPercent??0).toFixed(0)}),e.jsx("td",{className:"px-4 py-2 text-sm text-gray-900 text-right",children:t.totalCost.toFixed(2)})]},t._id)}),!u&&o.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-8 text-center text-sm text-gray-600",children:"No products"})})]})]})})})]}),e.jsxs("div",{className:"border border-gray-200 p-4 bg-white/95",children:[e.jsx("h2",{className:"text-base font-medium text-gray-900 mb-3",children:"Additional Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Reference Number"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.referenceNumber||"-"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Note to Supplier"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.noteToSupplier||"-"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Tax"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.totalTax?.toFixed(2)??"-"})]})]})]}),e.jsxs("div",{className:"border border-gray-200 p-4 bg-white/95",children:[e.jsx("h2",{className:"text-base font-medium text-gray-900 mb-3",children:"Cost Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"PO ID"}),e.jsx("p",{className:"text-sm text-gray-900",children:s._id})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Status"}),e.jsx("p",{className:"text-sm text-gray-900 capitalize",children:s.status.replaceAll("_"," ")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Expected Arrival"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.expectedArrivalDate?new Date(s.expectedArrivalDate).toLocaleDateString():"-"})]})]}),e.jsx("div",{className:"border-t border-gray-200 my-3"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Subtotal"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.subtotalCost?.toFixed(2)??"-"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Taxes"}),e.jsx("p",{className:"text-sm text-gray-900",children:s.totalTax?.toFixed(2)??"-"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Total"}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.totalCost?.toFixed(2)??"-"})]})]}),e.jsx("div",{className:"border-t border-gray-200 my-3"}),e.jsx("p",{className:"text-xs text-gray-600 mb-2",children:"Cost Adjustments"}),e.jsxs("div",{className:"space-y-1",children:[(s.costAdjustments??[]).length===0&&e.jsx("p",{className:"text-sm text-gray-600",children:"No adjustments"}),(s.costAdjustments??[]).map((t,r)=>e.jsxs("div",{className:"flex justify-between",children:[e.jsx("p",{className:"text-sm text-gray-900 capitalize",children:t.name}),e.jsxs("p",{className:"text-sm text-gray-900",children:[t.amount.toFixed(2),t.currency?` ${t.currency}`:""]})]},r))]}),e.jsx("div",{className:"border-t border-gray-200 my-3"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Converted Total"}),e.jsxs("p",{className:"text-sm text-gray-900",children:[s.totalCost?.toFixed(2)," ",s.supplierCurrency||""]})]})})]}),e.jsxs("div",{className:"border border-gray-200 p-4 bg-white/95",children:[e.jsx("h2",{className:"text-base font-medium text-gray-900 mb-3",children:"Timeline"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("textarea",{className:"w-full px-3 py-1.5 text-sm border border-gray-200 focus:outline-none focus:ring-1 focus:ring-gray-400 resize-y min-h-[100px]",placeholder:"Leave a comment..."}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{className:"px-3 py-1.5 text-sm font-medium bg-gray-900 text-white hover:bg-gray-800 transition-colors",children:"Post"})})]})]})]})]})]})})}export{F as default};
