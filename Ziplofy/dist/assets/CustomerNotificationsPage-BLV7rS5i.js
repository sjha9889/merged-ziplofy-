import{u as A,p as R,J as F,K as L,r as l,j as e,L as M,M as _,F as $,R as O}from"./index-C7S6h9OR.js";import{G as g}from"./GridBackgroundWrapper-Du1VLjut.js";import{F as u}from"./ChevronRightIcon-CVun6pAX.js";const G=()=>{const x=A(),{categoryId:i,categorySlug:d}=R(),{options:m,loading:v,fetchByCategoryId:y}=F(),{categories:p,fetchAll:N,loading:j}=L(),[C,b]=l.useState({}),n=d?.includes("customer");l.useEffect(()=>{p.length===0&&!j&&N().catch(()=>{})},[p.length,j,N]),l.useEffect(()=>{i&&y(i).catch(()=>{})},[i,y]),l.useEffect(()=>{if(!n)return;const t={};new Set(m.map(a=>a.segment).filter(Boolean)).forEach(a=>{a&&(t[a]=!0)}),b(t)},[m,n]);const k=l.useMemo(()=>{if(!i)return"Notifications";const t=p.find(s=>s._id===i);return t?.name?t.name:d?d.split("-").map(s=>s.charAt(0).toUpperCase()+s.slice(1)).join(" "):"Notifications"},[p,i,d]),h=l.useMemo(()=>{if(!n)return[];const t=new Map;m.forEach(a=>{const c=a.segment||"other";t.has(c)||t.set(c,[]),t.get(c).push(a)});const s={orders:"Order processing",localpickup:"Local pick up",localdelivery:"Local delivery",giftcards:"Gift cards",storecredit:"Store credit",orderexceptions:"Order exceptions",payments:"Payments",shippingupdated:"Shipping updated",returns:"Returns",accounts_and_outreach:"Accounts and outreach",other:"Other"};return Array.from(t.entries()).map(([a,c])=>{let r=s[a]||a;return s[a]||(r=a.replace(/_/g," "),/[A-Z]/.test(r)&&(r=r.split(/(?=[A-Z])/).map(o=>o.charAt(0).toUpperCase()+o.slice(1).toLowerCase()).join(" ")),r=r.split(" ").map(o=>o.charAt(0).toUpperCase()+o.slice(1).toLowerCase()).join(" ")),{title:r,items:c.sort((o,S)=>o.optionName.localeCompare(S.optionName))}})},[m,n]),f=l.useMemo(()=>n?[]:[...m].sort((t,s)=>t.optionName.localeCompare(s.optionName)),[m,n]),E=l.useCallback(t=>{b(s=>({...s,[t]:!s[t]}))},[]),w=t=>!i||!d?"/settings/notifications":`/settings/notifications/${i}/${d}/${t._id}`;return i?v?e.jsx(g,{children:e.jsx("div",{className:"max-w-7xl mx-auto py-8 px-4",children:e.jsx("div",{className:"flex justify-center mt-8",children:e.jsx("div",{className:"w-6 h-6 border-2 border-gray-400 border-t-transparent rounded-full animate-spin"})})})}):e.jsx(g,{children:e.jsxs("div",{className:"max-w-7xl mx-auto py-8 px-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 border-b border-gray-200 pb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>x("/settings/notifications"),className:"p-1 text-gray-600 hover:text-gray-900 transition-colors",children:e.jsx(M,{className:"w-5 h-5"})}),e.jsx(u,{className:"w-4 h-4 text-gray-500"}),e.jsx("h1",{className:"text-xl font-medium text-gray-900",children:k})]}),n&&e.jsx("button",{onClick:()=>{x("/settings/notifications/customer/templates")},className:"px-3 py-1.5 border border-gray-200 text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:"Customize email templates"})]}),n?h.length>0?e.jsx("div",{className:"border border-gray-200 p-4 bg-white/95",children:h.map((t,s)=>{const a=t.title.toLowerCase().replace(/\s+/g,""),c=C[a]??!0;return e.jsxs("div",{className:s<h.length-1?"mb-4 pb-4 border-b border-gray-200":"",children:[e.jsxs("button",{onClick:()=>E(a),className:"w-full flex items-center justify-between py-2 hover:bg-transparent transition-colors",children:[e.jsx("h2",{className:"text-sm font-medium text-gray-900 flex-1 text-left",children:t.title}),c?e.jsx(_,{className:"w-4 h-4 text-gray-500"}):e.jsx($,{className:"w-4 h-4 text-gray-500"})]}),e.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out ${c?"max-h-[2000px] opacity-100":"max-h-0 opacity-0"}`,children:e.jsx("div",{className:"pl-0 mt-2",children:t.items.map((r,o)=>e.jsx("div",{className:o<t.items.length-1?"mb-1 pb-1 border-b border-gray-100":"",children:e.jsxs("button",{onClick:()=>x(w(r)),className:"w-full flex items-center justify-between py-2 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 mb-0.5",children:r.optionName}),r.optionDesc&&e.jsx("p",{className:"text-xs text-gray-600",children:r.optionDesc})]}),e.jsx(u,{className:"w-4 h-4 text-gray-500 ml-3 shrink-0"})]})},r._id))})})]},s)})}):e.jsx("div",{className:"border border-gray-200 p-4 bg-white/95",children:e.jsx("p",{className:"text-xs text-gray-600",children:"No notification options found."})}):e.jsx("div",{className:"border border-gray-200 p-4 bg-white/95",children:f.length>0?f.map((t,s)=>e.jsxs(O.Fragment,{children:[e.jsxs("button",{onClick:()=>x(w(t)),className:"w-full flex items-center justify-between py-2 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 mb-0.5",children:t.optionName}),t.optionDesc&&e.jsx("p",{className:"text-xs text-gray-600",children:t.optionDesc})]}),e.jsx(u,{className:"w-4 h-4 text-gray-500 ml-3 shrink-0"})]}),s<f.length-1&&e.jsx("div",{className:"h-px bg-gray-200 my-2"})]},t._id)):e.jsx("p",{className:"text-xs text-gray-600",children:"No notification options found."})})]})}):e.jsx(g,{children:e.jsx("div",{className:"max-w-7xl mx-auto py-8 px-4",children:e.jsx("p",{className:"text-sm text-gray-900",children:"Notification category not found."})})})};export{G as default};
