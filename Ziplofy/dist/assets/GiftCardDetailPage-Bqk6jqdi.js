import{r as s,j as e,p as ye,u as ve,a as je,b as Ne,aS as we}from"./index-C7S6h9OR.js";import{M as B}from"./Modal-DsfhGJdg.js";import{F as Ce}from"./ArrowLeftIcon-C1qOxHB_.js";import{F as W}from"./TrashIcon-B2-WJkmb.js";import{F as S}from"./PencilIcon-MufFKs4H.js";import{F as z}from"./CurrencyDollarIcon-CizKWQ8x.js";import{F as ke}from"./PaperAirplaneIcon-BtNwzxYt.js";import{F as De}from"./EllipsisVerticalIcon-BmYIkkbK.js";import"./index-CCB_rw4P.js";function Ee({title:t,titleId:a,...r},n){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":a},r),t?s.createElement("title",{id:a},t):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5m-9-6h.008v.008H12v-.008ZM12 15h.008v.008H12V15Zm0 2.25h.008v.008H12v-.008ZM9.75 15h.008v.008H9.75V15Zm0 2.25h.008v.008H9.75v-.008ZM7.5 15h.008v.008H7.5V15Zm0 2.25h.008v.008H7.5v-.008Zm6.75-4.5h.008v.008h-.008v-.008Zm0 2.25h.008v.008h-.008V15Zm0 2.25h.008v.008h-.008v-.008Zm2.25-4.5h.008v.008H16.5v-.008Zm0 2.25h.008v.008H16.5V15Z"}))}const $=s.forwardRef(Ee);function Se({title:t,titleId:a,...r},n){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":a},r),t?s.createElement("title",{id:a},t):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 11.25v8.25a1.5 1.5 0 0 1-1.5 1.5H5.25a1.5 1.5 0 0 1-1.5-1.5v-8.25M12 4.875A2.625 2.625 0 1 0 9.375 7.5H12m0-2.625V7.5m0-2.625A2.625 2.625 0 1 1 14.625 7.5H12m0 0V21m-8.625-9.75h18c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125h-18c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125Z"}))}const Y=s.forwardRef(Se),Te=({isOpen:t,isDeactivating:a,onCancel:r,onConfirm:n})=>e.jsx(B,{open:t,onClose:r,title:"Deactivate Gift Card",maxWidth:"sm",actions:e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:r,disabled:a,className:"px-3 py-1.5 text-sm font-medium text-gray-700 border border-gray-200 hover:bg-gray-50 transition-colors disabled:opacity-50",children:"No"}),e.jsx("button",{onClick:n,disabled:a,className:"px-3 py-1.5 text-sm font-medium text-white bg-gray-900 hover:bg-gray-800 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:a?"Deactivating...":"Yes, Deactivate"})]}),children:e.jsx("p",{className:"text-sm text-gray-700",children:"Are you sure you want to deactivate this gift card? This action will make the gift card inactive and prevent further operations on it."})}),Ge=({isOpen:t,expirationOption:a,newExpirationDate:r,isUpdating:n,onClose:d,onExpirationOptionChange:c,onExpirationDateChange:o,onSave:m,hasChanges:x})=>e.jsxs(B,{open:t,onClose:d,title:"Edit Gift Card Expiration",maxWidth:"sm",actions:e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:d,disabled:n,className:"px-3 py-1.5 text-sm font-medium text-gray-700 border border-gray-200 hover:bg-gray-50 transition-colors disabled:opacity-50",children:"Cancel"}),e.jsx("button",{onClick:m,disabled:!x()||n,className:"px-3 py-1.5 text-sm font-medium text-white bg-gray-900 hover:bg-gray-800 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:n?"Updating...":"Done"})]}),children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-2",children:"Expiration Date Options"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"radio",name:"expirationOption",value:"no-expiration",checked:a==="no-expiration",onChange:c,className:"w-4 h-4 text-gray-900 border-gray-300 focus:ring-gray-400 cursor-pointer"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"No expiration date"})]}),e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"radio",name:"expirationOption",value:"set-expiration",checked:a==="set-expiration",onChange:c,className:"w-4 h-4 text-gray-900 border-gray-300 focus:ring-gray-400 cursor-pointer"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Set expiration date"})]})]})]}),a==="set-expiration"&&e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{htmlFor:"expirationDate",className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Expiration Date"}),e.jsx("input",{id:"expirationDate",type:"date",value:r,onChange:u=>o(u.target.value),min:new Date().toISOString().split("T")[0],className:"w-full px-3 py-1.5 border border-gray-200 rounded focus:ring-1 focus:ring-gray-400 focus:border-gray-400 outline-none transition-colors text-sm"})]})]}),Ae=({onBack:t,onDeactivate:a,isActive:r})=>e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:t,className:"inline-flex items-center gap-2 text-sm font-medium text-blue-600 hover:text-blue-700 mb-2 transition-colors",children:[e.jsx(Ce,{className:"w-4 h-4"}),"Back to gift cards"]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Gift Card Details"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Manage and view gift card information"})]}),e.jsxs("button",{onClick:a,disabled:!r,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-blue-600 border border-blue-200 rounded-lg hover:bg-blue-50 hover:border-blue-300 transition-colors disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-transparent disabled:hover:border-gray-200",children:[e.jsx(W,{className:"w-4 h-4"}),"Deactivate"]})]})]}),Fe=({giftCard:t,onEdit:a})=>e.jsx("div",{className:"md:col-span-4",children:e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200/80 p-6 shadow-sm flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-50 flex items-center justify-center mr-2",children:e.jsx(Y,{className:"w-4 h-4 text-blue-600"})}),e.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Gift Card"})]}),t.isActive&&e.jsx("button",{onClick:a,className:"p-1 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors",children:e.jsx(S,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Code"}),e.jsx("p",{className:"text-lg font-medium font-mono tracking-wide break-all text-gray-900",children:t.code})]}),e.jsxs("div",{className:"mb-4 flex items-center",children:[e.jsx(z,{className:"w-5 h-5 mr-2 text-blue-600"}),e.jsxs("span",{className:"text-xl font-medium text-gray-900",children:["₹",t.initialValue]})]}),e.jsx("div",{className:"mt-auto pt-3 border-t border-gray-200",children:e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${t.isActive?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"}`,children:t.isActive?"Active":"Inactive"})})]})}),Ie=({giftCard:t})=>e.jsx("div",{className:"md:col-span-4",children:e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200/80 p-6 shadow-sm h-full",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-50 flex items-center justify-center mr-2",children:e.jsx(Y,{className:"w-4 h-4 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-base font-semibold text-gray-900",children:"Gift Card Information"}),e.jsx("p",{className:"text-xs text-gray-600 mt-0.5",children:"Detailed information about this gift card"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"pb-3 border-b border-gray-200",children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Gift Card Code"}),e.jsx("p",{className:"text-sm font-medium font-mono tracking-wide text-gray-900",children:t.code})]}),e.jsxs("div",{className:"pb-3 border-b border-gray-200",children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Initial Value"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(z,{className:"w-4 h-4 text-blue-600 mr-1.5"}),e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["₹",t.initialValue]})]})]}),e.jsxs("div",{className:"pb-3 border-b border-gray-200",children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Status"}),e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${t.isActive?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"}`,children:t.isActive?"Active":"Inactive"})]}),e.jsxs("div",{className:"pb-3 border-b border-gray-200",children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Created Date"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx($,{className:"w-3.5 h-3.5 text-gray-600 mr-1.5"}),e.jsx("span",{className:"text-sm text-gray-700",children:new Date(t.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]})]}),t.expirationDate&&e.jsxs("div",{className:"pb-3 border-b border-gray-200",children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Expiration Date"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx($,{className:"w-3.5 h-3.5 text-gray-600 mr-1.5"}),e.jsx("span",{className:"text-sm text-gray-700",children:new Date(t.expirationDate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Last Updated"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx($,{className:"w-3.5 h-3.5 text-gray-600 mr-1.5"}),e.jsx("span",{className:"text-sm text-gray-700",children:new Date(t.updatedAt).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]})]})]})]})}),Me=({giftCard:t,isEditingNotes:a,editedNotes:r,isUpdatingNotes:n,onEditNotes:d,onCancelEditNotes:c,onSaveNotes:o,onNotesChange:m})=>e.jsx("div",{className:"md:col-span-4",children:e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200/80 p-6 shadow-sm h-full",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-50 flex items-center justify-center mr-2",children:e.jsx(S,{className:"w-4 h-4 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-base font-semibold text-gray-900",children:"Notes"}),e.jsx("p",{className:"text-xs text-gray-600 mt-0.5",children:"Additional information about this gift card"})]})]}),!a&&t.isActive&&e.jsx("button",{onClick:d,className:"p-1 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors",children:e.jsx(S,{className:"w-4 h-4"})})]}),a?e.jsxs("div",{children:[e.jsx("textarea",{value:r,onChange:x=>m(x.target.value),rows:4,placeholder:"Enter notes for this gift card...",className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/30 focus:border-blue-400 transition-colors resize-none mb-3 text-sm"}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx("button",{onClick:c,disabled:n,className:"px-4 py-2 text-sm font-medium text-gray-700 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50",children:"Cancel"}),e.jsx("button",{onClick:o,disabled:n,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:n?"Saving...":"Save"})]})]}):e.jsx("div",{className:"p-3 bg-gray-50 rounded border border-gray-200 min-h-[100px]",children:t.notes?e.jsx("p",{className:"text-sm text-gray-900 whitespace-pre-wrap leading-relaxed",children:t.notes}):e.jsx("p",{className:"text-sm text-gray-500 italic text-center py-6",children:"No notes available for this gift card"})})]})}),Oe=({isOpen:t,timelineLoading:a,onCancel:r,onConfirm:n})=>e.jsx(B,{open:t,onClose:r,title:"Delete Timeline Entry",maxWidth:"sm",actions:e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:r,className:"px-3 py-1.5 text-sm font-medium text-gray-700 border border-gray-200 hover:bg-gray-50 transition-colors",children:"No"}),e.jsx("button",{onClick:n,disabled:a,className:"px-3 py-1.5 text-sm font-medium text-white bg-gray-900 hover:bg-gray-800 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Yes, Delete"})]}),children:e.jsx("p",{className:"text-sm text-gray-700",children:"Do you really want to delete this timeline comment? This action cannot be undone."})}),He=({comment:t,onCommentChange:a,onPostComment:r})=>e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"relative",children:[e.jsx("textarea",{value:t,onChange:n=>a(n.target.value),rows:3,placeholder:"Add a comment to this gift card...",className:"w-full px-3 py-2 pr-20 border border-gray-200 rounded focus:ring-1 focus:ring-gray-400 focus:border-gray-400 outline-none transition-colors resize-none text-sm"}),e.jsxs("button",{onClick:r,disabled:!t.trim(),className:"absolute bottom-2 right-2 flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium text-white bg-gray-900 rounded hover:bg-gray-800 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:[e.jsx(ke,{className:"w-3.5 h-3.5"}),"Post"]})]})}),Ze=({entry:t,editingTimelineId:a,editComment:r,onEditCommentChange:n,onEditTimeline:d,onDeleteTimeline:c,onCancelEdit:o,onSaveEdit:m})=>{const x=a===t._id;return e.jsxs("div",{className:`p-3 rounded border ${t.type==="event"?"bg-blue-50 border-blue-200":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${t.type==="event"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-700"}`,children:t.type==="event"?"Event":"Comment"}),e.jsx("span",{className:"text-xs text-gray-600",children:new Date(t.createdAt).toLocaleString()})]}),!x&&e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>d(t._id,t.comment),className:"p-1 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded transition-colors",children:e.jsx(S,{className:"w-3.5 h-3.5"})}),e.jsx("button",{onClick:()=>c(t._id),className:"p-1 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded transition-colors",children:e.jsx(W,{className:"w-3.5 h-3.5"})})]})]}),x?e.jsxs("div",{children:[e.jsx("textarea",{value:r,onChange:u=>n(u.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-200 rounded focus:ring-1 focus:ring-gray-400 focus:border-gray-400 outline-none transition-colors resize-none mb-3 text-sm"}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx("button",{onClick:o,className:"px-3 py-1.5 text-sm font-medium text-gray-700 border border-gray-200 rounded hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:m,disabled:!r.trim(),className:"px-3 py-1.5 text-sm font-medium text-white bg-gray-900 rounded hover:bg-gray-800 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:"Save"})]})]}):e.jsx("p",{className:"text-sm text-gray-900 whitespace-pre-wrap",children:t.comment})]})},Re=({timelineEntries:t,editingTimelineId:a,editComment:r,onEditCommentChange:n,onEditTimeline:d,onDeleteTimeline:c,onCancelEdit:o,onSaveEdit:m})=>e.jsx("div",{className:"flex flex-col gap-4",children:t.map(x=>e.jsx(Ze,{entry:x,editingTimelineId:a,editComment:r,onEditCommentChange:n,onEditTimeline:d,onDeleteTimeline:c,onCancelEdit:o,onSaveEdit:m},x._id))}),Ve=({comment:t,onCommentChange:a,onPostComment:r,timelineEntries:n,timelineLoading:d,timelineError:c,editingTimelineId:o,editComment:m,onEditCommentChange:x,onEditTimeline:u,onDeleteTimeline:T,onCancelEdit:p,onSaveEdit:f,deleteDialogOpen:y,onConfirmDelete:v,onCancelDelete:i})=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mt-6",children:e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200/80 p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-50 flex items-center justify-center mr-2",children:e.jsx(De,{className:"w-4 h-4 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-base font-semibold text-gray-900",children:"Timeline"}),e.jsx("p",{className:"text-xs text-gray-600 mt-0.5",children:"Track gift card activities and comments"})]})]}),e.jsx(He,{comment:t,onCommentChange:a,onPostComment:r}),d?e.jsx("div",{className:"flex justify-center items-center py-6",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-900"})}):c?e.jsx("div",{className:"mb-3 bg-red-50 border border-red-200 text-red-700 px-3 py-2 rounded text-sm",children:c}):n.length===0?e.jsx("div",{className:"p-4 bg-gray-50 rounded border border-dashed border-gray-300",children:e.jsx("p",{className:"text-sm text-gray-500 text-center",children:"No timeline entries yet. Be the first to add a comment!"})}):e.jsx(Re,{timelineEntries:n,editingTimelineId:o,editComment:m,onEditCommentChange:x,onEditTimeline:u,onDeleteTimeline:T,onCancelEdit:p,onSaveEdit:f})]})}),e.jsx(Oe,{isOpen:y,timelineLoading:d,onCancel:i,onConfirm:v})]}),Je=()=>{const{giftCardId:t}=ye(),a=ve(),{giftCards:r,loading:n,error:d,fetchGiftCardsByStoreId:c,updateGiftCard:o}=je(),{activeStoreId:m}=Ne(),{timelineEntries:x,loading:u,error:T,getTimelineByGiftCardId:p,deleteTimelineEntry:f,createTimelineEntry:y,updateTimelineEntry:v}=we(),i=s.useMemo(()=>r.find(l=>l._id===t),[r,t]),[j,L]=s.useState(""),[q,G]=s.useState(!1),[A,F]=s.useState(null),[N,I]=s.useState(null),[w,C]=s.useState(""),[J,_]=s.useState(!1),[b,k]=s.useState("no-expiration"),[h,g]=s.useState(""),[K,M]=s.useState(!1),[Q,O]=s.useState(!1),[H,D]=s.useState(""),[X,P]=s.useState(!1),[ee,Z]=s.useState(!1),[te,U]=s.useState(!1);s.useEffect(()=>{m&&r.length===0&&c(m)},[m,r.length,c]),s.useEffect(()=>{t&&p(t)},[t,p]);const R=s.useCallback(()=>{a("/products/gift-cards")},[a]),se=s.useCallback(()=>{i?.expirationDate?(k("set-expiration"),g(i.expirationDate.split("T")[0])):(k("no-expiration"),g("")),_(!0)},[i]),ae=s.useCallback(()=>{Z(!0)},[]),re=s.useCallback(l=>{F(l),G(!0)},[]),ie=s.useCallback(async()=>{if(A)try{await f(A),G(!1),F(null)}catch(l){console.error("Error deleting timeline entry:",l)}},[A,f]),ne=s.useCallback(()=>{G(!1),F(null)},[]),le=s.useCallback(async()=>{if(!(!j.trim()||!t))try{await y({giftCardId:t,comment:j.trim()}),L("")}catch(l){console.error("Error posting comment:",l)}},[j,t,y]),oe=s.useCallback((l,V)=>{I(l),C(V)},[]),de=s.useCallback(async()=>{if(!(!N||!w.trim()))try{await v(N,{comment:w.trim()}),I(null),C("")}catch(l){console.error("Error updating timeline entry:",l)}},[N,w,v]),ce=s.useCallback(()=>{I(null),C("")},[]),E=s.useCallback(()=>{_(!1),k("no-expiration"),g(""),M(!1)},[]),me=s.useCallback(l=>{k(l.target.value),l.target.value==="no-expiration"&&g("")},[]),xe=s.useCallback(async()=>{if(i){M(!0);try{let l={};b==="no-expiration"?l.expirationDate=void 0:h&&(l.expirationDate=new Date(h).toISOString()),(i.expirationDate?i.expirationDate.split("T")[0]:null)!==(b==="no-expiration"?null:h)&&await o(i._id,l),E()}catch(l){console.error("Error updating gift card:",l)}finally{M(!1)}}},[i,b,h,o,E]),ue=s.useCallback(()=>i?(i.expirationDate?i.expirationDate.split("T")[0]:null)!==(b==="no-expiration"?null:h):!1,[i,b,h]),he=s.useCallback(()=>{D(i?.notes||""),O(!0)},[i]),be=s.useCallback(()=>{D(""),O(!1)},[]),ge=s.useCallback(async()=>{if(i){P(!0);try{await o(i._id,{notes:H}),O(!1),D("")}catch(l){console.error("Error updating notes:",l)}finally{P(!1)}}},[i,H,o]),pe=s.useCallback(()=>{Z(!1)},[]),fe=s.useCallback(async()=>{if(i){U(!0);try{await o(i._id,{isActive:!1}),Z(!1)}catch(l){console.error("Error deactivating gift card:",l)}finally{U(!1)}}},[i,o]);return n?e.jsx("div",{className:"min-h-screen bg-page-background-color flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})}):d?e.jsx("div",{className:"min-h-screen bg-page-background-color",children:e.jsxs("div",{className:"max-w-[1400px] mx-auto px-3 sm:px-4 py-4",children:[e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm mb-4",children:d}),e.jsx("button",{onClick:R,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:"Back to Gift Cards"})]})}):i?e.jsxs("div",{className:"min-h-screen bg-page-background-color",children:[e.jsxs("div",{className:"max-w-[1400px] mx-auto px-3 sm:px-4 py-4",children:[e.jsx(Ae,{onBack:R,onDeactivate:ae,isActive:i.isActive}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-6 mb-6",children:[e.jsx(Fe,{giftCard:i,onEdit:se}),e.jsx(Ie,{giftCard:i}),e.jsx(Me,{giftCard:i,isEditingNotes:Q,editedNotes:H,isUpdatingNotes:X,onEditNotes:he,onCancelEditNotes:be,onSaveNotes:ge,onNotesChange:D})]}),e.jsx(Ve,{comment:j,onCommentChange:L,onPostComment:le,timelineEntries:x,timelineLoading:u,timelineError:T,editingTimelineId:N,editComment:w,onEditCommentChange:C,onEditTimeline:oe,onDeleteTimeline:re,onCancelEdit:ce,onSaveEdit:de,deleteDialogOpen:q,onConfirmDelete:ie,onCancelDelete:ne})]}),e.jsx(Ge,{isOpen:J,giftCard:i,expirationOption:b,newExpirationDate:h,isUpdating:K,onClose:E,onExpirationOptionChange:me,onExpirationDateChange:g,onSave:xe,hasChanges:ue}),e.jsx(Te,{isOpen:ee,isDeactivating:te,onCancel:pe,onConfirm:fe})]}):e.jsx("div",{className:"min-h-screen bg-page-background-color",children:e.jsxs("div",{className:"max-w-[1400px] mx-auto px-3 sm:px-4 py-4",children:[e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 text-yellow-700 px-4 py-3 rounded-lg text-sm mb-4",children:"Gift card not found"}),e.jsx("button",{onClick:R,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:"Back to Gift Cards"})]})})};export{Je as default};
