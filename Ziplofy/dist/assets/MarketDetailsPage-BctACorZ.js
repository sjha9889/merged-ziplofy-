import{p as oe,u as de,R as t,Z as ie,_ as ce,$ as q,b as xe,j as e,k as H,i as Z}from"./index-C7S6h9OR.js";import{F as me}from"./ArrowLeftIcon-C1qOxHB_.js";import{F as ue}from"./PencilIcon-MufFKs4H.js";const fe=()=>{const{marketId:a}=oe(),N=de(),[n,w]=t.useState(""),[o,k]=t.useState("active"),[C,G]=t.useState(null),{countries:S,getCountries:J,loading:K}=ie(),{createItem:Q,deleteItem:U,getByMarketId:I,items:V,loading:M}=ce(),{deleteMarket:W,updateMarket:D}=q(),{markets:$,getByStoreId:R}=q(),{activeStoreId:b}=xe(),[X,E]=t.useState(!1),[d,O]=t.useState(""),[i,h]=t.useState(!1),[ee,F]=t.useState(!1),[se,c]=t.useState(!1),[x,z]=t.useState(null),[te,p]=t.useState(!1),[m,y]=t.useState(""),[P,_]=t.useState(!1),[ae,f]=t.useState(!1),[A,j]=t.useState("active"),[L,B]=t.useState(!1),[ge,be]=t.useState(!1),v=t.useRef(null);t.useEffect(()=>{const s=g=>{v.current&&!v.current.contains(g.target)&&h(!1)};return i&&document.addEventListener("mousedown",s),()=>{document.removeEventListener("mousedown",s)}},[i]);const re=()=>{F(!0),h(!1)},T=()=>F(!1),ne=()=>{E(!0),J({limit:250}).catch(()=>{})},u=()=>{E(!1),O("")};t.useEffect(()=>{a&&I(a).catch(()=>{})},[a,I]);const r=t.useMemo(()=>$.find(s=>s._id===a),[$,a]);return t.useEffect(()=>{!r&&b&&R(b).catch(()=>{})},[r,b,R]),t.useEffect(()=>{r&&(w(r.name),y(r.name),k(r.status),j(r.status),G(r.parentMarketId??null))},[r]),e.jsxs("div",{className:"min-h-screen bg-page-background-color",children:[e.jsxs("div",{className:"max-w-[1400px] mx-auto px-3 sm:px-4 py-4",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>N("/markets"),className:"inline-flex items-center gap-2 text-sm font-medium text-blue-600 hover:text-blue-700 mb-3 transition-colors",children:[e.jsx(me,{className:"w-4 h-4"}),e.jsx("span",{children:"Back"})]}),e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[te?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",value:m,onChange:s=>y(s.target.value),className:"px-3 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/30 focus:border-blue-400 text-sm"}),e.jsx("button",{disabled:P||!a||!m.trim(),onClick:async()=>{if(!(!a||!m.trim()))try{_(!0);const s=await D(a,{name:m.trim()});w(s.name),p(!1)}finally{_(!1)}},className:"px-4 py-2 text-sm font-medium bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:P?"Saving...":"Save"}),e.jsx("button",{onClick:()=>{y(n),p(!1)},className:"px-4 py-2 text-sm font-medium text-gray-700 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:n}),e.jsx("button",{onClick:()=>p(!0),className:"p-1.5 text-gray-600 hover:text-blue-600 transition-colors rounded-lg hover:bg-blue-50","aria-label":"Edit name",children:e.jsx(ue,{className:"w-4 h-4"})})]}),e.jsx("span",{className:"px-2.5 py-1 text-xs font-medium bg-gray-100 text-gray-700 rounded-lg",children:"Region"}),e.jsx("span",{className:`px-2.5 py-1 text-xs font-medium rounded-lg ${o==="active"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"}`,children:o==="active"?"Active":"Draft"}),e.jsx("div",{className:"flex-1"}),e.jsxs("div",{className:"relative",ref:v,children:[e.jsx("button",{onClick:()=>h(!i),className:"px-4 py-2 text-sm font-medium border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:"More actions"}),i&&e.jsx("div",{className:"absolute right-0 mt-1 w-48 bg-white border border-gray-200 rounded-lg shadow-lg z-10 overflow-hidden",children:e.jsx("button",{onClick:re,className:"w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-gray-50 transition-colors",children:"Delete market"})})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200/80 p-6 shadow-sm",children:[e.jsx("h2",{className:"text-base font-semibold text-gray-900 mb-4",children:"Status"}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("span",{className:"text-sm text-gray-600 flex-1",children:n}),ae?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"relative",children:e.jsxs("select",{value:A,onChange:s=>j(s.target.value),className:"px-3 py-2 text-sm border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/30 focus:border-blue-400",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"draft",children:"Draft"})]})}),e.jsx("button",{disabled:L||!a,onClick:async()=>{if(a)try{B(!0);const s=await D(a,{status:A});k(s.status),f(!1)}finally{B(!1)}},className:"px-4 py-2 text-sm font-medium bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:L?"Saving...":"Save"}),e.jsx("button",{onClick:()=>{j(o),f(!1)},className:"px-4 py-2 text-sm font-medium text-gray-700 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[o==="active"?e.jsx("span",{className:"px-2 py-0.5 text-xs font-medium bg-green-100 text-green-700",children:"Active"}):e.jsx("span",{className:"px-2 py-0.5 text-xs font-medium bg-gray-100 text-gray-600",children:"Draft"}),e.jsx("button",{onClick:()=>f(!0),className:"px-3 py-1.5 text-xs font-medium text-blue-600 hover:text-blue-700 transition-colors",children:"Edit"})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-4 mt-4",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 mb-3",children:"Includes"}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap mb-2",children:[M&&e.jsx("span",{className:"text-sm text-gray-600",children:"Loading..."}),!M&&V.map(s=>{const l=typeof s.countryId=="object"&&s.countryId!==null?s.countryId:S.find(le=>le._id===s.countryId),Y=l?`${l.name} (${l.iso2})`:typeof s.countryId=="string"?s.countryId:"";return e.jsxs("div",{className:"inline-flex items-center gap-1.5 bg-gray-100 px-2 py-1",children:[e.jsx("span",{className:"text-sm text-gray-700",children:Y}),e.jsx("button",{onClick:()=>{z({id:s._id,countryName:l?l.name:Y}),c(!0)},className:"p-0.5 text-gray-600 hover:text-red-600 transition-colors",children:e.jsx(H,{className:"w-3.5 h-3.5"})})]},s._id)})]}),e.jsxs("button",{onClick:ne,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-blue-600 border border-blue-200 rounded-lg hover:bg-blue-50 transition-colors",children:[e.jsx(Z,{className:"w-4 h-4"}),"Add condition"]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200/80 p-6 shadow-sm",children:[e.jsx("h2",{className:"text-base font-semibold text-gray-900 mb-2",children:"Customized"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Create unique configurations for customers in this market"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Inherited"}),e.jsx("div",{className:"bg-white rounded-xl border border-gray-200/80 shadow-sm overflow-hidden",children:[["Currency","→ Indian Rupee (INR ₹)"],["Catalogs","→ All products"],["Domain / language","→ example.myshopify.com • English"],["Taxes and duties","→ Not collecting"],["Online Store","→ Horizon"]].map((s,g)=>e.jsxs(t.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-900 w-40",children:s[0]}),e.jsx("span",{className:"text-sm text-gray-600",children:s[1]})]}),e.jsx("button",{className:"p-1.5 text-gray-600 hover:text-blue-600 rounded-lg hover:bg-blue-50 transition-colors",children:e.jsx(Z,{className:"w-4 h-4"})})]}),g<4&&e.jsx("div",{className:"border-t border-gray-200"})]},s[0]))})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-white rounded-xl border border-gray-200/80 p-6 shadow-sm min-h-[200px]",children:e.jsx("div",{className:"w-full h-40 bg-gray-100 rounded-lg"})}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200/80 p-6 shadow-sm",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Parent market"}),e.jsx("div",{className:"bg-gray-50 px-3 py-2 text-sm text-gray-700 rounded-lg",children:C||"Store default"})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200/80 p-6 shadow-sm",children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-900 mb-4",children:["More Settings for ",n]}),e.jsxs("div",{className:"border border-gray-200 p-4 mb-3 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-1",children:"Shipping"}),e.jsx("p",{className:"text-xs text-gray-600",children:"1 rate • Shipping to India"})]}),e.jsxs("div",{className:"border border-gray-200 p-4 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-1",children:"Customer privacy"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Cookie banner, Data sharing opt-out"})]})]})]})]})]}),X&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-gray-500/20 z-[1400]",onClick:u}),e.jsx("div",{className:"fixed inset-0 z-[1500] flex items-center justify-center p-4 pointer-events-none",children:e.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl border border-gray-200 shadow-lg pointer-events-auto",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[e.jsx("h2",{className:"text-base font-semibold text-gray-900",children:"Select a country to include"}),e.jsx("button",{onClick:u,className:"p-1.5 text-gray-600 hover:text-gray-900 transition-colors rounded-lg hover:bg-gray-100",children:e.jsx(H,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"px-6 py-4",children:e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Country"}),e.jsx("div",{className:"relative",children:e.jsxs("select",{value:d,onChange:s=>O(s.target.value),disabled:K,className:"w-full px-3 py-2 text-sm border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/30 focus:border-blue-400 disabled:bg-gray-50",children:[e.jsx("option",{value:"",children:"Select a country"}),S.map(s=>e.jsx("option",{value:s._id,children:`${s.name} (${s.iso2})`},s._id))]})})]})}),e.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex justify-end gap-3",children:[e.jsx("button",{onClick:u,className:"px-4 py-2 text-sm font-medium text-gray-700 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{disabled:!d||!a,onClick:async()=>{!a||!d||(await Q({marketId:a,countryId:d}),u())},className:"px-4 py-2 text-sm font-medium bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:"Save"})]})]})})]}),se&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-gray-500/20 z-[1400]",onClick:()=>c(!1)}),e.jsx("div",{className:"fixed inset-0 z-[1500] flex items-center justify-center p-4 pointer-events-none",children:e.jsxs("div",{className:"bg-white w-full max-w-xs rounded-xl border border-gray-200 shadow-lg pointer-events-auto",onClick:s=>s.stopPropagation(),children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h2",{className:"text-base font-semibold text-gray-900",children:`Remove country from ${n}`})}),e.jsx("div",{className:"px-6 py-4",children:e.jsx("p",{className:"text-sm text-gray-600",children:`You really want to delete ${x?.countryName??"this country"} from ${n}?`})}),e.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>c(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:"No"}),e.jsx("button",{disabled:!x,onClick:async()=>{x&&(await U(x.id),c(!1),z(null))},className:"px-4 py-2 text-sm font-medium bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:"Yes"})]})]})})]}),ee&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-gray-500/20 z-[1400]",onClick:T}),e.jsx("div",{className:"fixed inset-0 z-[1500] flex items-center justify-center p-4 pointer-events-none",children:e.jsxs("div",{className:"bg-white w-full max-w-xs rounded-xl border border-gray-200 shadow-lg pointer-events-auto",onClick:s=>s.stopPropagation(),children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h2",{className:"text-base font-semibold text-gray-900",children:`Delete ${n}?`})}),e.jsx("div",{className:"px-6 py-4",children:e.jsx("p",{className:"text-sm text-gray-600",children:`Your market ${n} will be permanently deleted.`})}),e.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex justify-end gap-3",children:[e.jsx("button",{onClick:T,className:"px-4 py-2 text-sm font-medium text-gray-700 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:async()=>{a&&(await W(a),N("/markets"))},className:"px-4 py-2 text-sm font-medium bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Delete"})]})]})})]})]})};export{fe as default};
