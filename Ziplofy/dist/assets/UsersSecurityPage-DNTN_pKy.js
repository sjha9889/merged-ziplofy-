import{r as t,b as j,ae as N,O as s,j as e}from"./index-C7S6h9OR.js";import{G as C}from"./GridBackgroundWrapper-Du1VLjut.js";import{F as S}from"./TrashIcon-B2-WJkmb.js";function q({title:i,titleId:a,...r},c){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:c,"aria-labelledby":a},r),i?t.createElement("title",{id:a},i):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 7.5V6.108c0-1.135.845-2.098 1.976-2.192.373-.03.748-.057 1.123-.08M15.75 18H18a2.25 2.25 0 0 0 2.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 0 0-1.123-.08M15.75 18.75v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5A3.375 3.375 0 0 0 6.375 7.5H5.25m11.9-3.664A2.251 2.251 0 0 0 15 2.25h-1.5a2.251 2.251 0 0 0-2.15 1.586m5.8 0c.065.21.1.433.1.664v.75h-6V4.5c0-.231.035-.454.1-.664M6.75 7.5H4.875c-.621 0-1.125.504-1.125 1.125v12c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V16.5a9 9 0 0 0-9-9Z"}))}const k=t.forwardRef(q),G=()=>{const{stores:i,activeStoreId:a}=j(),{settings:r,loading:c,fetchByStoreId:u,update:d,generateNewCode:x}=N(),g=t.useMemo(()=>i.find(o=>o._id===a),[i,a]),[M,n]=t.useState(!1),[y,m]=t.useState(!1),[h,b]=t.useState(!1);t.useEffect(()=>{a&&u(a).catch(()=>{})},[a,u]),t.useEffect(()=>{n(r?r.requireCode:!1)},[r]);const f=t.useCallback(()=>{if(!r?.securityCode){s.dismiss(),s.error("No security code to copy");return}navigator.clipboard.writeText(r.securityCode).then(()=>{s.dismiss(),s.success("Security code copied")}).catch(()=>{s.dismiss(),s.error("Failed to copy code")})},[r]),p=t.useCallback(async()=>{if(!r?._id){s.dismiss(),s.error("Settings not available");return}b(!0);try{await x(r._id),s.dismiss(),s.success("New security code generated successfully")}catch(o){const l=o?.message||"Failed to generate new security code";s.dismiss(),s.error(l)}finally{b(!1)}},[r,x]),v=t.useCallback(async()=>{if(!a||!r){s.dismiss(),s.error("Settings not available");return}m(!0);try{await d(r._id,{requireCode:!1}),s.dismiss(),s.success("Security code requirement disabled"),n(!1)}catch(o){const l=o?.message||"Failed to disable security code requirement";s.dismiss(),s.error(l)}finally{m(!1)}},[a,r,d]),w=t.useCallback(async()=>{if(!a||!r){s.dismiss(),s.error("Settings not available");return}m(!0);try{await d(r._id,{requireCode:!0}),s.dismiss(),s.success("Security code requirement enabled"),n(!0)}catch(o){const l=o?.message||"Failed to enable security code requirement";s.dismiss(),s.error(l)}finally{m(!1)}},[a,r,d]);return e.jsx(C,{children:e.jsxs("div",{className:"max-w-7xl mx-auto py-8 px-4",children:[c&&e.jsx("div",{className:"flex justify-center py-4",children:e.jsx("div",{className:"w-5 h-5 border-2 border-gray-300 border-t-gray-900 rounded-full animate-spin"})}),!c&&r&&e.jsxs("div",{className:"border border-gray-200 bg-white p-4",children:[e.jsx("h2",{className:"text-base font-medium text-gray-900 mb-1",children:"Collaborators"}),e.jsxs("p",{className:"text-xs text-gray-600 mb-3",children:["Give designers, developers, and marketers access to this store. Collaborators don't count toward your staff limit. Learn more about"," ",e.jsx("a",{href:"#",className:"text-gray-700 hover:underline",children:"collaborators"}),"."]}),!r.requireCode&&e.jsx("div",{className:"border border-gray-200 p-3 bg-gray-50",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"text-xs text-gray-600",children:["Anyone can send a collaborator request for ",g?.storeName||"My Store",". A code is not required."]}),e.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["You'll still need to review and approve this request from"," ",e.jsx("a",{href:"#",className:"text-gray-700 hover:underline",children:"Users"}),"."]})]}),e.jsx("button",{onClick:w,disabled:y,className:"px-3 py-1.5 text-sm border border-gray-200 text-gray-700 bg-white hover:bg-gray-50 transition-colors disabled:bg-gray-100 disabled:cursor-not-allowed",children:"Require code"})]})}),r.requireCode&&e.jsx("div",{className:"border border-gray-200 p-3 bg-gray-50",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs text-gray-600 uppercase tracking-wide",children:"My Store"}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:g?.storeName||"My Store"}),e.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Share this code to allow someone to send you a collaborator request for this store. You'll still need to review and approve this request from"," ",e.jsx("a",{href:"#",className:"text-gray-700 hover:underline",children:"Users"}),"."]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.securityCode&&e.jsx("button",{onClick:f,className:"px-3 py-1.5 text-sm border border-gray-200 text-gray-700 bg-white hover:bg-gray-50 transition-colors font-mono font-medium",children:e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(k,{className:"w-4 h-4"}),r.securityCode]})}),e.jsx("button",{onClick:p,disabled:h,className:"px-3 py-1.5 text-sm text-white bg-gray-900 hover:bg-gray-800 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:h?e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-3 h-3 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Generating..."]}):"Generate new code"}),e.jsx("button",{onClick:v,disabled:y,className:"p-1.5 text-gray-600 hover:text-gray-900 hover:bg-gray-100 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(S,{className:"w-4 h-4"})})]})]})})]})]})})};export{G as default};
